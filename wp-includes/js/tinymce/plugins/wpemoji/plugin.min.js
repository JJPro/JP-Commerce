(function(g,e){g.PluginManager.add("wpemoji",function(b){function h(a){e.emoji.parse(a,{imgAttr:{"data-mce-resize":"false","data-mce-placeholder":"1","data-wp-emoji":"1"}})}function k(a){var d,c;a&&window.twemoji&&window.twemoji.test(a.textContent||a.innerText)&&(f.webkit&&(d=b.selection,c=d.getBookmark()),h(a),f.webkit&&d.moveToBookmark(c))}var l,f=g.Env,m=window.navigator.userAgent,n=-1<m.indexOf("Windows"),p=function(){var a=m.match(/Windows NT 6\.(\d)/);return a&&1<a[1]?!0:!1}();if(e&&e.emoji&&
e.emoji.replaceEmoji){if(p)b.on("keyup",function(a){231===a.keyCode&&k(b.selection.getNode())});else n||(b.on("keydown keyup",function(a){l="keydown"===a.type}),b.on("input",function(){l||k(b.selection.getNode())}));b.on("setcontent",function(a){var d=b.selection,c=d.getNode();window.twemoji&&window.twemoji.test(c.textContent||c.innerText)&&(h(c),f.ie&&9>f.ie&&a.load&&c&&"BODY"===c.nodeName&&d.collapse(!0))});b.on("PastePostProcess",function(a){window.twemoji&&g.each(b.dom.$("img.emoji",a.node),function(a){a.alt&&
window.twemoji.test(a.alt)&&(a.className="emoji",a.setAttribute("data-mce-resize","false"),a.setAttribute("data-mce-placeholder","1"),a.setAttribute("data-wp-emoji","1"))})});b.on("postprocess",function(a){a.content&&(a.content=a.content.replace(/<img[^>]+data-wp-emoji="[^>]+>/g,function(a){var b=a.match(/alt="([^"]+)"/);return b&&b[1]?b[1]:a}))});b.on("resolvename",function(a){"IMG"===a.target.nodeName&&b.dom.getAttrib(a.target,"data-wp-emoji")&&a.preventDefault()})}})})(window.tinymce,window.wp);
