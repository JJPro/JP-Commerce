(function(A,F){function I(k,n){for(var f,m=[],a=0;a<k.length;++a){if(!(f=B[k[a]]))a:{f=A;for(var d=k[a].split(/[.\/]/),r=0;r<d.length;++r){if(!f[d[r]]){f=void 0;break a}f=f[d[r]]}}if(!f)throw"module definition dependecy not found: "+k[a];m.push(f)}n.apply(null,m)}function C(k,n,f){if("string"!==typeof k)throw"invalid module definition, module id must be defined and be a string";if(n===F)throw"invalid module definition, dependencies must be specified";if(f===F)throw"invalid module definition, definition function must be specified";
I(n,function(){B[k]=f.apply(null,arguments)})}var B={};C("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(k,n,f){function m(a,d){k.each(d,function(d){a=d.constructor==RegExp?a.replace(d,""):a.replace(d[0],d[1])});return a}return{filter:m,innerText:function(a){function d(a){var f=a.name,k=a;if("br"===f)c+="\n";else if(u[f]&&(c+=" "),l[f])c+=" ";else{3==a.type&&(c+=a.value);if(!a.shortEnded&&(a=a.firstChild)){do d(a);while(a=a.next)}x[f]&&k.next&&
(c+="\n","p"==f&&(c+="\n"))}}var r=new f,t=new n({},r),c="",u=r.getShortEndedElements(),l=k.makeMap("script noscript style textarea video audio iframe object"," "),x=r.getBlockElements();a=m(a,[/<!\[[^\]]+\]>/g]);d(t.parse(a));return c},trimHtml:function(a){return a=m(a,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/\x3c!--StartFragment--\x3e|\x3c!--EndFragment--\x3e/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(a,f,k){return f||k?"\u00a0":" "}],/<br>$/i])}}});C("tinymce/pasteplugin/Clipboard",
["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(k,n,f,m){return function(a){function d(b){var h,e=a.dom;h=a.fire("BeforePastePreProcess",{content:b});h=a.fire("PastePreProcess",h);b=h.content;h.isDefaultPrevented()||(a.hasEventListeners("PastePostProcess")&&!h.isDefaultPrevented()&&(b=e.add(a.getBody(),"div",{style:"display:none"},b),h=a.fire("PastePostProcess",{node:b}),e.remove(b),b=h.node.innerHTML),h.isDefaultPrevented()||a.insertContent(b,{merge:!1!==
a.settings.paste_merge_formats,data:{paste:!0}}))}function r(b){b=a.dom.encode(b).replace(/\r\n/g,"\n");var h=a.dom.getParent(a.selection.getStart(),a.dom.isBlock),e=a.settings.forced_root_block,g;e&&(g=a.dom.createHTML(e,a.settings.forced_root_block_attrs),g=g.substr(0,g.length-3)+">");h&&/^(PRE|DIV)$/.test(h.nodeName)||!e?b=m.filter(b,[[/\n/g,"<br>"]]):(b=m.filter(b,[[/\n\n/g,"</p>"+g],[/^(.*<\/p>)(<p>)$/,g+"$1"],[/\n/g,"<br />"]]),-1!=b.indexOf("<p>")&&(b=g+b));d(b)}function t(){function b(b){var a,
e;e=b.startContainer;a=b.getClientRects();if(a.length)return a[0];if(b.collapsed&&1==e.nodeType){for(b=e.childNodes[v.startOffset];b&&3==b.nodeType&&!b.data.length;)b=b.nextSibling;if(b&&("BR"==b.tagName&&(e=h.doc.createTextNode("\ufeff"),b.parentNode.insertBefore(e,b),b=h.createRng(),b.setStartBefore(e),b.setEndAfter(e),a=b.getClientRects(),h.remove(e)),a.length))return a[0]}}var h=a.dom,e=a.getBody(),g=a.dom.getViewPort(a.getWin()).y,c=20,d;v=a.selection.getRng();a.inline&&(d=a.selection.getScrollContainer())&&
0<d.scrollTop&&(g=d.scrollTop);if(v.getClientRects)if(c=b(v))c=g+(c.top-h.getPos(e).y);else if(c=g,g=v.startContainer)3==g.nodeType&&g.parentNode!=e&&(g=g.parentNode),1==g.nodeType&&(c=h.getPos(g,d||e).y);q=h.add(a.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+c+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},"%MCEPASTEBIN%");(k.ie||k.gecko)&&h.setStyle(q,"left","rtl"==h.getStyle(e,"direction",!0)?65535:-65535);h.bind(q,
"beforedeactivate focusin focusout",function(b){b.stopPropagation()});q.focus();a.selection.select(q,!0)}function c(){if(q){for(var b;b=a.dom.get("mcepastebin");)a.dom.remove(b),a.dom.unbind(b);v&&a.selection.setRng(v)}q=v=null}function u(){var b="",h,e,g;h=a.dom.select("div[id=mcepastebin]");for(e=0;e<h.length;e++)g=h[e],g.firstChild&&"mcepastebin"==g.firstChild.id&&(g=g.firstChild),g=g.innerHTML,"%MCEPASTEBIN%"!=b&&(b+=g);return b}function l(b){var a={};if(b){if(b.getData){var e=b.getData("Text");
e&&0<e.length&&-1==e.indexOf("data:text/mce-internal,")&&(a["text/plain"]=e)}if(b.types)for(e=0;e<b.types.length;e++){var g=b.types[e];a[g]=b.getData(g)}}return a}function x(b,h){function e(e){function g(b){h&&(a.selection.setRng(h),h=null);d('<img src="'+b.result+'">')}var c,y,p;p=!1;if(e)for(c=0;c<e.length;c++)y=e[c],/^image\/(jpeg|png|gif|bmp)$/.test(y.type)&&(p=new FileReader,p.onload=g.bind(null,p),p.readAsDataURL(y.getAsFile?y.getAsFile():y),b.preventDefault(),p=!0);return p}var g=b.clipboardData||
b.dataTransfer;if(a.settings.paste_data_images&&g)return e(g.items)||e(g.files)}function G(b){b=b.clipboardData;return-1!=navigator.userAgent.indexOf("Android")&&b&&b.items&&0===b.items.length}function E(b,a){return a in b&&0<b[a].length}function w(b){return f.metaKeyPressed(b)&&86==b.keyCode||b.shiftKey&&45==b.keyCode}function D(){a.on("keydown",function(b){function h(b){w(b)&&!b.isDefaultPrevented()&&c()}w(b)&&!b.isDefaultPrevented()&&(p=b.shiftKey&&86==b.keyCode,p&&k.webkit&&-1!=navigator.userAgent.indexOf("Version/")||
(b.stopImmediatePropagation(),y=(new Date).getTime(),k.ie&&p?(b.preventDefault(),a.fire("paste",{ieFake:!0})):(c(),t(),a.once("keyup",h),a.once("paste",function(){a.off("keyup",h)}))))});a.on("paste",function(b){var h=(new Date).getTime(),e=l(b.clipboardData||a.getDoc().dataTransfer),h=(new Date).getTime()-h,g=1E3>(new Date).getTime()-y-h,f="text"==z.pasteFormat||p;p=!1;b.isDefaultPrevented()||G(b)?c():x(b)?c():(g||b.preventDefault(),!k.ie||g&&!b.ieFake||(t(),a.dom.bind(q,"paste",function(b){b.stopPropagation()}),
a.getDoc().execCommand("Paste",!1,null),e["text/html"]=u()),setTimeout(function(){var b;E(e,"text/html")?b=e["text/html"]:(b=u(),"%MCEPASTEBIN%"==b&&(f=!0));b=m.trimHtml(b);q&&q.firstChild&&"mcepastebin"===q.firstChild.id&&(f=!0);c();b.length||(f=!0);f&&(b=E(e,"text/plain")&&-1==b.indexOf("</p>")?e["text/plain"]:m.innerText(b));"%MCEPASTEBIN%"==b?g||a.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):f?r(b):d(b)},0))});a.on("dragstart dragend",function(b){H="dragstart"==
b.type});a.on("drop",function(b){var c=n.getCaretRangeFromPoint(b.clientX,b.clientY,a.getDoc());if(!b.isDefaultPrevented()&&!H&&!x(b,c)&&c&&!1!==a.settings.paste_filter_drop){var e=l(b.dataTransfer),g=e["mce-internal"]||e["text/html"]||e["text/plain"];g&&(b.preventDefault(),a.undoManager.transact(function(){e["mce-internal"]&&a.execCommand("Delete");a.selection.setRng(c);g=m.trimHtml(g);e["text/html"]?d(g):r(g)}))}});a.on("dragover dragend",function(b){a.settings.paste_data_images&&b.preventDefault()})}
var z=this,q,v,y=0,H=!1,p;z.pasteHtml=d;z.pasteText=r;a.on("preInit",function(){D();a.parser.addNodeFilter("img",function(b,c,e){function g(b){b.attr("data-mce-object")||d===k.transparentSrc||b.remove()}if(!a.settings.paste_data_images&&e.data&&!0===e.data.paste)for(c=b.length;c--;){var d=b[c].attributes.map.src;d&&(0===d.indexOf("webkit-fake-url")?g(b[c]):a.settings.allow_html_data_urls||0!==d.indexOf("data:")||g(b[c]))}})})}});C("tinymce/pasteplugin/WordFilter","tinymce/util/Tools tinymce/html/DomParser tinymce/html/Schema tinymce/html/Serializer tinymce/html/Node tinymce/pasteplugin/Utils".split(" "),
function(k,n,f,m,a,d){function r(a){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(a)||/class="OutlineElement/.test(a)||/id="?docs\-internal\-guid\-/.test(a)}function t(a){var c;a=a.replace(/^[\u00a0 ]+/,"");k.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],
function(d){if(d.test(a))return c=!0,!1});return c}function c(c){var l=c.settings;c.on("BeforePastePreProcess",function(x){function G(c){function d(b){var a="";if(3===b.type)return b.value;if(b=b.firstChild){do a+=d(b);while(b=b.next)}return a}function p(b,a){if(3===b.type&&a.test(b.value))return b.value=b.value.replace(a,""),!1;if(b=b.firstChild){do if(!p(b,a))return!1;while(b=b.next)}return!0}function b(a){if(a._listIgnore)a.remove();else if(a=a.firstChild){do b(a);while(a=a.next)}}function h(c,
d,h){var l=c._listLevel||f;l!=f&&(l<f?e&&(e=e.parent.parent):(g=e,e=null));e&&e.name==d?e.append(c):(g=g||e,e=new a(d,1),1<h&&e.attr("start",""+h),c.wrap(e));c.name="li";l>f&&g&&g.lastChild.append(e);f=l;b(c);p(c,/^\u00a0+/);p(c,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);p(c,/^\u00a0+/)}for(var e,g,f=1,k=[],l=c.firstChild;"undefined"!==typeof l&&null!==l;)if(k.push(l),l=l.walk(),null!==l)for(;"undefined"!==typeof l&&l.parent!==c;)l=l.walk();for(l=0;l<k.length;l++)if(c=k[l],"p"==c.name&&c.firstChild){var u=
d(c);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(u))h(c,"ul");else if(t(u)){var u=/([0-9]+)\./.exec(u),m=1;u&&(m=parseInt(u[1],10));h(c,"ol",m)}else c._listLevel?h(c,"ul",1):e=null}else g=e,e=null}function E(d,f){var p={},b,h=c.dom.parseStyle(f);k.each(h,function(a,c){switch(c){case "mso-list":if(b=/\w+ \w+([0-9]+)/i.exec(f))d._listLevel=parseInt(b[1],10);/Ignore/i.test(a)&&d.firstChild&&(d._listIgnore=!0,d.firstChild._listIgnore=!0);break;case "horiz-align":c="text-align";break;case "vert-align":c=
"vertical-align";break;case "font-color":case "mso-foreground":c="color";break;case "mso-background":case "mso-highlight":c="background";break;case "font-weight":case "font-style":"normal"!=a&&(p[c]=a);return;case "mso-element":if(/^(comment|comment-list)$/i.test(a)){d.remove();return}}0===c.indexOf("mso-comment")?d.remove():0!==c.indexOf("mso-")&&("all"==D||z&&z[c])&&(p[c]=a)});/(bold)/i.test(p["font-weight"])&&(delete p["font-weight"],d.wrap(new a("b",1)));/(italic)/i.test(p["font-style"])&&(delete p["font-style"],
d.wrap(new a("i",1)));return(p=c.dom.serializeStyle(p,d.name))?p:null}var w=x.content,D,z,w=w.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),w=w.replace(/<br class="?Apple-interchange-newline"?>/gi,"");(D=l.paste_retain_style_properties)&&(z=k.makeMap(D.split(/[, ]/)));if(!1!==l.paste_enable_default_filters&&r(x.content)){x.wordContent=!0;var w=d.filter(w,[/\x3c!--[\s\S]+?--\x3e/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,
"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,c){return 0<c.length?c.replace(/./," ").slice(Math.floor(c.length/2)).split("").join("\u00a0"):""}]]),q=l.paste_word_valid_elements;q||(q="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");q=new f({valid_elements:q,valid_children:"-li[p]"});
k.each(q.elements,function(a){a.attributes["class"]||(a.attributes["class"]={},a.attributesOrder.push("class"));a.attributes.style||(a.attributes.style={},a.attributesOrder.push("style"))});var v=new n({},q);v.addAttributeFilter("style",function(a){for(var c=a.length,d;c--;)d=a[c],d.attr("style",E(d,d.attr("style"))),"span"==d.name&&d.parent&&!d.attributes.length&&d.unwrap()});v.addAttributeFilter("class",function(a){for(var c=a.length,d,b;c--;)d=a[c],b=d.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(b)&&
d.remove(),d.attr("class",null)});v.addNodeFilter("del",function(a){for(var c=a.length;c--;)a[c].remove()});v.addNodeFilter("a",function(a){for(var c=a.length,d,b,f;c--;)d=a[c],b=d.attr("href"),f=d.attr("name"),b&&-1!=b.indexOf("#_msocom_")?d.remove():(b&&0===b.indexOf("file://")&&(b=b.split("#")[1])&&(b="#"+b),b||f?f&&!/^_?(?:toc|edn|ftn)/i.test(f)?d.unwrap():d.attr({href:b,name:f}):d.unwrap())});w=v.parse(w);!1!==l.paste_convert_word_fake_lists&&G(w);x.content=(new m({},q)).serialize(w)}})}c.isWordContent=
r;return c});C("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(k,n,f,m){return function(a){function d(c){a.on("BeforePastePreProcess",function(a){a.content=c(a.content)})}function r(c){if(!f.isWordContent(c))return c;var d=[];n.each(a.schema.getBlockElements(),function(a,c){d.push(c)});var l=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+d.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");c=m.filter(c,
[[l,"$1"]]);return c=m.filter(c,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function t(c){if(f.isWordContent(c))return c;var d=a.settings.paste_webkit_styles;if(!1===a.settings.paste_remove_styles_if_webkit||"all"==d)return c;d&&(d=d.split(/[, ]/));if(d){var l=a.dom,k=a.selection.getNode();c=c.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(a,c,f,m){a=l.parseStyle(f,"span");f={};if("none"===d)return c+m;for(var n=0;n<d.length;n++){var q=a[d[n]],r=l.getStyle(k,d[n],!0);/color/.test(d[n])&&
(q=l.toHex(q),r=l.toHex(r));r!=q&&(f[d[n]]=q)}return(f=l.serializeStyle(f,"span"))?c+' style="'+f+'"'+m:c+m})}else c=c.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return c=c.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(a,c,d,f){return c+' style="'+d+'"'+f})}k.webkit&&d(t);k.ie&&d(r)}});C("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(k,n,f,m){var a;k.add("paste",
function(d){function k(){"text"==c.pasteFormat?(this.active(!1),c.pasteFormat="html"):(c.pasteFormat="text",this.active(!0),a||(d.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),a=!0))}var t=this,c,u=d.settings;t.clipboard=c=new n(d);t.quirks=new m(d);t.wordFilter=new f(d);d.settings.paste_as_text&&(t.clipboard.pasteFormat="text");if(u.paste_preprocess)d.on("PastePreProcess",function(a){u.paste_preprocess.call(t,t,
a)});if(u.paste_postprocess)d.on("PastePostProcess",function(a){u.paste_postprocess.call(t,t,a)});d.addCommand("mceInsertClipboardContent",function(a,c){c.content&&t.clipboard.pasteHtml(c.content);c.text&&t.clipboard.pasteText(c.text)});if(d.paste_block_drop)d.on("dragend dragover draggesture dragdrop drop drag",function(a){a.preventDefault();a.stopPropagation()});if(!d.settings.paste_data_images)d.on("drop",function(a){var c=a.dataTransfer;c&&c.files&&0<c.files.length&&a.preventDefault()});d.addButton("pastetext",
{icon:"pastetext",tooltip:"Paste as text",onclick:k,active:"text"==t.clipboard.pasteFormat});d.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:c.pasteFormat,onclick:k})})});(function(k){var n,f,m,a;for(n=0;n<k.length;n++){f=A;m=k[n];a=m.split(/[.\/]/);for(var d=0;d<a.length-1;++d)f[a[d]]===F&&(f[a[d]]={}),f=f[a[d]];f[a[a.length-1]]=B[m]}if(A.AMDLC_TESTS){f=A.privateModules||{};for(m in B)f[m]=B[m];for(n=0;n<k.length;n++)delete f[k[n]];A.privateModules=f}})(["tinymce/pasteplugin/Utils"])})(this);
