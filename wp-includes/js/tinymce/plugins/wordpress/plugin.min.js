(function(e){e.ui.FloatPanel.zIndex=100100;e.PluginManager.add("wordpress",function(a){function C(b){var c,m,d=0;c="hide"===b;a.theme.panel&&(m=a.theme.panel.find(".toolbar:not(.menubar)"));!m||2>m.length||"hide"===b&&!m[1].visible()||(!b&&m[1].visible()&&(b="hide"),n(m,function(a,c){0<c&&("hide"===b?(a.hide(),d+=30):(a.show(),d-=30))}),d&&!c&&(e.Env.iOS||(c=a.getContentAreaContainer().firstChild,y.setStyle(c,"height",c.clientHeight+d)),"hide"===b?(setUserSetting("hidetb","0"),k&&k.active(!1)):(setUserSetting("hidetb",
"1"),k&&k.active(!0))),a.fire("wp-toolbar-toggle"))}function t(){}var k,p,y=e.DOM,n=e.each,h=a.editorManager.i18n.translate,g=window.jQuery,f=window.wp,D=f&&f.editor&&f.editor.autop&&a.getParam("wpautop",!0);g&&g(document).triggerHandler("tinymce-editor-setup",[a]);a.addButton("wp_adv",{tooltip:"Toolbar Toggle",cmd:"WP_Adv",onPostRender:function(){k=this;k.active("1"===getUserSetting("hidetb")?!0:!1)}});a.on("PostRender",function(){a.getParam("wordpress_adv_hidden",!0)&&"0"===getUserSetting("hidetb",
"0")&&C("hide")});a.addCommand("WP_Adv",function(){C()});a.on("focus",function(){window.wpActiveEditor=a.id});a.on("BeforeSetContent",function(a){var c;a.content&&(-1!==a.content.indexOf("\x3c!--more")&&(c=h("Read more..."),a.content=a.content.replace(/\x3c!--more(.*?)--\x3e/g,function(a,b){return'<img src="'+e.Env.transparentSrc+'" data-wp-more="more" data-wp-more-text="'+b+'" class="wp-more-tag mce-wp-more" title="'+c+'" data-mce-resize="false" data-mce-placeholder="1" />'})),-1!==a.content.indexOf("\x3c!--nextpage--\x3e")&&
(c=h("Page break"),a.content=a.content.replace(/\x3c!--nextpage--\x3e/g,'<img src="'+e.Env.transparentSrc+'" data-wp-more="nextpage" class="wp-more-tag mce-wp-nextpage" title="'+c+'" data-mce-resize="false" data-mce-placeholder="1" />')),a.load&&"raw"!==a.format&&D&&(a.content=f.editor.autop(a.content)),a.content=a.content.replace(/<p>(?:&nbsp;|\u00a0|\uFEFF|\s)+<\/p>/gi,"<p><br /></p>"))});a.on("PostProcess",function(a){a.get&&(a.content=a.content.replace(/<img[^>]+>/g,function(a){var b="";if(-1!==
a.indexOf('data-wp-more="more"')){if(a=a.match(/data-wp-more-text="([^"]+)"/))b=a[1];a="\x3c!--more"+b+"--\x3e"}else-1!==a.indexOf('data-wp-more="nextpage"')&&(a="\x3c!--nextpage--\x3e");return a}))});a.on("ResolveName",function(b){var c;"IMG"===b.target.nodeName&&(c=a.dom.getAttrib(b.target,"data-wp-more"))&&(b.name=c)});a.addCommand("WP_More",function(b){var c,m,d="wp-more-tag",r=a.dom;c=a.selection.getNode();b=b||"more";d+=" mce-wp-"+b;m=h("more"===b?"Read more...":"Next page");b='<img src="'+
e.Env.transparentSrc+'" title="'+m+'" class="'+d+'" data-wp-more="'+b+'" data-mce-resize="false" data-mce-placeholder="1" />';if("BODY"===c.nodeName||"P"===c.nodeName&&"BODY"===c.parentNode.nodeName)a.insertContent(b);else if(c=r.getParent(c,function(a){return a.parentNode&&"BODY"===a.parentNode.nodeName?!0:!1},a.getBody()))"P"===c.nodeName?c.appendChild(r.create("p",null,b).firstChild):r.insertAfter(r.create("p",null,b),c),a.nodeChanged()});a.addCommand("WP_Code",function(){a.formatter.toggle("code")});
a.addCommand("WP_Page",function(){a.execCommand("WP_More","nextpage")});a.addCommand("WP_Help",function(){function b(a){var b="<tr>";n(a,function(a,c){b=a?b+("<td><kbd>"+c+"</kbd></td><td>"+h(a)+"</td>"):b+"<td></td><td></td>"});return b+"</tr>"}var c=e.Env.mac?h("Ctrl + Alt + letter:"):h("Shift + Alt + letter:"),m=e.Env.mac?h("Cmd + letter:"):h("Ctrl + letter:"),d=[],r=[],f;n([{c:"Copy",x:"Cut"},{v:"Paste",a:"Select all"},{z:"Undo",y:"Redo"},{b:"Bold",i:"Italic"},{u:"Underline",k:"Insert/edit link"}],
function(a){d.push(b(a))});n([{1:"Heading 1",2:"Heading 2"},{3:"Heading 3",4:"Heading 4"},{5:"Heading 5",6:"Heading 6"},{l:"Align left",c:"Align center"},{r:"Align right",j:"Justify"},{d:"Strikethrough",q:"Blockquote"},{u:"Bullet list",o:"Numbered list"},{a:"Insert/edit link",s:"Remove link"},{m:"Insert/edit image",t:"Insert Read More tag"},{h:"Keyboard Shortcuts",x:"Code"},{p:"Insert Page Break tag",w:"Distraction-free writing mode"}],function(a){r.push(b(a))});f=[h("Letter"),h("Action"),h("Letter"),
h("Action")];f="<tr><th>"+f.join("</th><th>")+"</th></tr>";c='<div class="wp-editor-help"><h2>'+h("Default shortcuts,")+" "+m+'</h2><table class="wp-help-th-center">'+f+d.join("")+"</table><h2>"+h("Additional shortcuts,")+" "+c+'</h2><table class="wp-help-th-center">'+f+r.join("")+"</table>";a.plugins.wptextpattern&&(c=c+"<h2>"+h("When starting a new paragraph with one of these formatting shortcuts followed by a space, the formatting will be applied automatically. Press Backspace or Escape to undo.")+
"</h2><table>"+b({"*":"Bullet list"})+b({"-":"Bullet list"})+b({"1.":"Numbered list"})+b({"1)":"Numbered list"})+"</table>",c=c+"<h2>"+h("The following formatting shortcuts are replaced when pressing Enter. Press Escape or the Undo button to undo.")+"</h2><table>"+b({">":"Blockquote"})+b({"##":"Heading 2"})+b({"###":"Heading 3"})+b({"####":"Heading 4"})+b({"#####":"Heading 5"})+b({"######":"Heading 6"})+"</table>");c=c+"<h2>"+h("Focus shortcuts:")+"</h2><table>"+b({"Alt + F8":"Inline toolbar (when an image, link or preview is selected)"})+
b({"Alt + F9":"Editor menu (when enabled)"})+b({"Alt + F10":"Editor toolbar"})+b({"Alt + F11":"Elements path"})+"</table><p>"+h("To move focus to other buttons use Tab or the arrow keys. To return focus to the editor press Escape or use one of the buttons.")+"</p>";c=a.windowManager.open({title:"Keyboard Shortcuts",items:{type:"container",classes:"wp-help",html:c+"</div>"},buttons:{text:"Close",onclick:"close"}});c.$el&&(c.$el.find('div[role="application"]').attr("role","document"),c=c.$el.find(".mce-wp-help"),
c[0]&&(c.attr("tabindex","0"),c[0].focus(),c.on("keydown",function(a){33<=a.keyCode&&40>=a.keyCode&&a.stopPropagation()})))});a.addCommand("WP_Medialib",function(){f&&f.media&&f.media.editor&&f.media.editor.open(a.id)});a.addButton("wp_more",{tooltip:"Insert Read More tag",onclick:function(){a.execCommand("WP_More","more")}});a.addButton("wp_page",{tooltip:"Page break",onclick:function(){a.execCommand("WP_More","nextpage")}});a.addButton("wp_help",{tooltip:"Keyboard Shortcuts",cmd:"WP_Help"});a.addButton("wp_code",
{tooltip:"Code",cmd:"WP_Code",stateSelector:"code"});f&&f.media&&f.media.editor&&a.addMenuItem("add_media",{text:"Add Media",icon:"wp-media-library",context:"insert",cmd:"WP_Medialib"});a.addMenuItem("wp_more",{text:"Insert Read More tag",icon:"wp_more",context:"insert",onclick:function(){a.execCommand("WP_More","more")}});a.addMenuItem("wp_page",{text:"Page break",icon:"wp_page",context:"insert",onclick:function(){a.execCommand("WP_More","nextpage")}});a.on("BeforeExecCommand",function(b){!e.Env.webkit||
"InsertUnorderedList"!==b.command&&"InsertOrderedList"!==b.command||(p||(p=a.dom.create("style",{type:"text/css"},"#tinymce,#tinymce span,#tinymce li,#tinymce li>span,#tinymce p,#tinymce p>span{font:medium sans-serif;color:#000;line-height:normal;}")),a.getDoc().head.appendChild(p))});a.on("ExecCommand",function(b){e.Env.webkit&&p&&("InsertUnorderedList"===b.command||"InsertOrderedList"===b.command)&&a.dom.remove(p)});a.on("init",function(){var b=e.Env,c=["mceContentBody"],f=a.getDoc(),d=a.dom;b.iOS&&
d.addClass(f.documentElement,"ios");"rtl"===a.getParam("directionality")&&(c.push("rtl"),d.setAttrib(f.documentElement,"dir","rtl"));b.ie?9===parseInt(b.ie,10)?c.push("ie9"):8===parseInt(b.ie,10)?c.push("ie8"):8>b.ie&&c.push("ie7"):b.webkit&&c.push("webkit");c.push("wp-editor");n(c,function(a){a&&d.addClass(f.body,a)});a.on("BeforeSetContent",function(a){a.content&&(a.content=a.content.replace(/<p>\s*<(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)( [^>]*)?>/gi,"<$1$2>").replace(/<\/(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre)>\s*<\/p>/gi,
"</$1>"))});g&&g(document).triggerHandler("tinymce-editor-init",[a]);window.tinyMCEPreInit&&window.tinyMCEPreInit.dragDropUpload&&d.bind(f,"dragstart dragend dragover drop",function(a){g&&g(document).trigger(new g.Event(a))});if(a.getParam("wp_paste_filters",!0)){if(!e.Env.webkit)a.on("PastePreProcess",function(a){a.content=a.content.replace(/(<[^>]+) style="[^"]*"([^>]*>)/gi,"$1$2");a.content=a.content.replace(/(<[^>]+) data-mce-style=([^>]+>)/gi,"$1 style=$2")});a.on("PastePostProcess",function(a){n(d.select("p",
a.node),function(a){d.isEmpty(a)&&d.remove(a)})})}});a.on("SaveContent",function(b){!a.inline&&a.isHidden()?b.content=b.element.value:(b.content=b.content.replace(/<p>(?:<br ?\/?>|\u00a0|\uFEFF| )*<\/p>/g,"<p>&nbsp;</p>"),D&&(b.content=f.editor.removep(b.content)))});a.on("preInit",function(){a.schema.addValidElements("@[id|accesskey|class|dir|lang|style|tabindex|title|contenteditable|draggable|dropzone|hidden|spellcheck|translate],i,b,script[src|async|defer|type|charset|crossorigin|integrity]");
e.Env.iOS&&(a.settings.height=300);n({c:"JustifyCenter",r:"JustifyRight",l:"JustifyLeft",j:"JustifyFull",q:"mceBlockQuote",u:"InsertUnorderedList",o:"InsertOrderedList",s:"unlink",m:"WP_Medialib",z:"WP_Adv",t:"WP_More",d:"Strikethrough",h:"WP_Help",p:"WP_Page",x:"WP_Code"},function(b,c){a.shortcuts.add("access+"+c,"",b)});a.addShortcut("meta+s","",function(){f&&f.autosave&&f.autosave.server.triggerSave()})});a.on("preinit",function(){function b(a){if(d)if(d.hide(),"hide"===a.type)d=!1;else if("resize"===
a.type||"scroll"===a.type)clearTimeout(g),g=setTimeout(function(){d&&"function"===typeof d.show&&d.show()},250)}var c=e.ui.Factory,f=a.settings,d,h,g,k=a.getContainer(),p=document.getElementById("wpadminbar"),t=document.getElementById(a.id+"_ifr"),z,A,B;k&&(z=e.$(".mce-toolbar-grp",k)[0],A=e.$(".mce-statusbar",k)[0]);"content"===a.id&&(B=document.getElementById("post-status-info"));a.shortcuts.add("alt+119","",function(){var a;d&&(a=d.find("toolbar")[0])&&a.focus(!0)});a.on("nodechange",function(b){var c=
a.selection.isCollapsed();b={element:b.element,parents:b.parents,collapsed:c};a.fire("wptoolbar",b);h=b.selection||b.element;d&&d.hide();b.toolbar?(d=b.toolbar,d.show()):d=!1});a.on("focus",function(){d&&d.show()});y.bind(window,"resize scroll",b);a.dom.bind(a.getWin(),"resize scroll",b);a.on("remove",function(){y.unbind(window,"resize scroll",b);a.dom.unbind(a.getWin(),"resize scroll",b)});a.on("blur hide",b);a.wp=a.wp||{};a.wp._createToolbar=function(b,d){var e,k=[],g;n(b,function(b){function d(){var c=
a.selection;"bullist"===e&&c.selectorChanged("ul > li",function(a,c){for(var d=c.parents.length,e;d--&&(e=c.parents[d].nodeName,"OL"!==e&&"UL"!=e););b.active(a&&"UL"===e)});"numlist"===e&&c.selectorChanged("ol > li",function(a,c){for(var d=c.parents.length,e;d--&&(e=c.parents[d].nodeName,"OL"!==e&&"UL"!==e););b.active(a&&"OL"===e)});b.settings.stateSelector&&c.selectorChanged(b.settings.stateSelector,function(a){b.active(a)},!0);b.settings.disabledStateSelector&&c.selectorChanged(b.settings.disabledStateSelector,
function(a){b.disabled(a)})}var e;if("|"===b)g=null;else if(c.has(b))b={type:b},f.toolbar_items_size&&(b.size=f.toolbar_items_size),k.push(b),g=null;else if(g||(g={type:"buttongroup",items:[]},k.push(g)),a.buttons[b])if(e=b,b=a.buttons[e],"function"===typeof b&&(b=b()),b.type=b.type||"button",f.toolbar_items_size&&(b.size=f.toolbar_items_size),b=c.create(b),g.items.push(b),a.initialized)d();else a.on("init",d)});e=c.create({type:"panel",layout:"stack",classes:"toolbar-grp inline-toolbar-grp",ariaRoot:!0,
ariaRemember:!0,items:[{type:"toolbar",layout:"flow",items:k}]});e.bottom=d;e.on("show",function(){this.reposition()});e.on("keydown",function(b){27===b.keyCode&&(this.hide(),a.focus())});a.on("remove",function(){e.remove()});e.reposition=function(){if(!h)return this;var a=window.pageXOffset||document.documentElement.scrollLeft,b=window.pageYOffset||document.documentElement.scrollTop,c=window.innerWidth,d=window.innerHeight,e=t?t.getBoundingClientRect():{top:0,right:c,bottom:d,left:0,width:c,height:d},
f=this.getEl(),g=f.offsetWidth,k=f.offsetHeight,l=h.getBoundingClientRect(),m=(l.left+l.right)/2,n=k+8+5,v=p?p.getBoundingClientRect().bottom:0,q=z?z.getBoundingClientRect().bottom:0,w=A?d-A.getBoundingClientRect().top:0,x=B?d-B.getBoundingClientRect().top:0,v=Math.max(0,v,q,e.top),q=Math.max(0,w,x,d-e.bottom),w=l.top+e.top-v,x=d-e.top-l.bottom-q,q=d-v-q,d="",u;if(w>=q||x>=q)return this.hide();this.bottom?x>=n?(d=" mce-arrow-up",u=l.bottom+e.top+b):w>=n&&(d=" mce-arrow-down",u=l.top+e.top+b-k-8):
w>=n?(d=" mce-arrow-down",u=l.top+e.top+b-k-8):x>=n&&q/2>l.bottom+e.top-v&&(d=" mce-arrow-up",u=l.bottom+e.top+b);"undefined"===typeof u&&(u=b+v+5);b=m-g/2+e.left+a;0>l.left||l.right>e.width?b=e.left+a+(e.width-g)/2:g>=c?(d+=" mce-arrow-full",b=0):0>b&&l.left+g>c||b+g>c&&0>l.right-g?b=(c-g)/2:b<e.left+a?(d+=" mce-arrow-left",b=l.left+e.left+a):b+g>e.width+e.left+a&&(d+=" mce-arrow-right",b=l.right-g+e.left+a);f.className=f.className.replace(/ ?mce-arrow-[\w]+/g,"")+d;y.setStyles(f,{left:b,top:u});
return this};e.hide().renderTo(document.body);return e}},!0);return{_showButtons:t,_hideButtons:t,_setEmbed:t,_getEmbed:t}})})(window.tinymce);
