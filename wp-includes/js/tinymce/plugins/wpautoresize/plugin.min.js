tinymce.PluginManager.add("wpautoresize",function(a){function g(d){var b,c,h,k=tinymce.DOM,e,n,p,q,r,t;if(m&&(c=a.getDoc()))if(d=d||{},b=c.body,h=c.documentElement,c=f.autoresize_min_height,!b||d&&"setcontent"===d.type&&d.initial||a.plugins.fullscreen&&a.plugins.fullscreen.isFullscreen())b&&h&&(b.style.overflowY="auto",h.style.overflowY="auto");else{e=a.dom.getStyle(b,"margin-top",!0);n=a.dom.getStyle(b,"margin-bottom",!0);p=a.dom.getStyle(b,"padding-top",!0);q=a.dom.getStyle(b,"padding-bottom",!0);
r=a.dom.getStyle(b,"border-top-width",!0);t=a.dom.getStyle(b,"border-bottom-width",!0);(e=b.offsetHeight+(parseInt(e,10)||0)+(parseInt(n,10)||0)+(parseInt(p,10)||0)+(parseInt(q,10)||0)+(parseInt(r,10)||0)+(parseInt(t,10)||0))&&e<h.offsetHeight&&(e=h.offsetHeight);if(isNaN(e)||0>=e)e=tinymce.Env.ie?b.scrollHeight:tinymce.Env.webkit&&0===b.clientHeight?0:b.offsetHeight;e>f.autoresize_min_height&&(c=e);f.autoresize_max_height&&e>f.autoresize_max_height?(c=f.autoresize_max_height,b.style.overflowY="auto",
h.style.overflowY="auto"):(b.style.overflowY="hidden",h.style.overflowY="hidden",b.scrollTop=0);c!==l&&(b=c-l,k.setStyle(a.iframeElement,"height",c+"px"),l=c,tinymce.isWebKit&&0>b&&g(d),a.fire("wp-autoresize",{height:c,deltaHeight:"nodechange"===d.type?b:null}))}}function k(a,b,c){setTimeout(function(){g();a--?k(a,b,c):c&&c()},b)}function u(){a.dom.hasClass(a.getBody(),"wp-autoresize")||(m=!0,a.dom.addClass(a.getBody(),"wp-autoresize"),a.on("nodechange setcontent keyup FullscreenStateChanged",g),
g())}function v(){var d;f.wp_autoresize_on||(m=!1,d=a.getDoc(),a.dom.removeClass(a.getBody(),"wp-autoresize"),a.off("nodechange setcontent keyup FullscreenStateChanged",g),d.body.style.overflowY="auto",d.documentElement.style.overflowY="auto",l=0)}var f=a.settings,l=300,m=!1;if(!a.settings.inline&&!tinymce.Env.iOS){f.autoresize_min_height=parseInt(a.getParam("autoresize_min_height",a.getElement().offsetHeight),10);f.autoresize_max_height=parseInt(a.getParam("autoresize_max_height",0),10);if(f.wp_autoresize_on&&
(m=!0,a.on("init",function(){a.dom.addClass(a.getBody(),"wp-autoresize")}),a.on("nodechange keyup FullscreenStateChanged",g),a.on("setcontent",function(){k(3,100)}),a.getParam("autoresize_on_init",!0)))a.on("init",function(){k(10,200,function(){k(5,1E3)})});a.on("show",function(){l=0});a.addCommand("wpAutoResize",g);a.addCommand("wpAutoResizeOn",u);a.addCommand("wpAutoResizeOff",v)}});
