(function(b){b.fn.filter_visible=function(e){e=e||3;return this.filter(function(){var f=b(this),a;for(a=0;a<e-1;++a){if(!f.is(":visible"))return!1;f=f.parent()}return!0})};b.table_hotkeys=function(e,f,a){a=b.extend(b.table_hotkeys.defaults,a);var k,p,g,l,q,h,r,t,u,m,v,w,n;k=a.class_prefix+a.selected_suffix;p=a.class_prefix+a.destructive_suffix;g=function(a){b.table_hotkeys.current_row&&b.table_hotkeys.current_row.removeClass(k);a.addClass(k);a[0].scrollIntoView(!1);b.table_hotkeys.current_row=a};
l=function(c){if(!h(c)&&b.isFunction(a[c+"_page_link_cb"]))a[c+"_page_link_cb"]()};q=function(c){return b.table_hotkeys.current_row?("prev"==c?b.fn.prevAll:b.fn.nextAll).call(b.table_hotkeys.current_row,a.cycle_expr).filter_visible()[0]:(c=m(),b.table_hotkeys.current_row=c,c[0])};h=function(a){a=q(a);if(!a)return!1;g(b(a));return!0};r=function(){return h("prev")};t=function(){return h("next")};u=function(){b(a.checkbox_expr,b.table_hotkeys.current_row).each(function(){this.checked=!this.checked})};
m=function(){return b(a.cycle_expr,e).filter_visible().eq(a.start_row_index)};v=function(){var c=b(a.cycle_expr,e).filter_visible();return c.eq(c.length-1)};w=function(a){return function(){if(null==b.table_hotkeys.current_row)return!1;var d=b(a,b.table_hotkeys.current_row);if(!d.length)return!1;d.is("."+p)&&(t()||r());d.click()}};n=m();n.length&&(a.highlight_first?g(n):a.highlight_last&&g(v()),b.hotkeys.add(a.prev_key,a.hotkeys_opts,function(){return l("prev")}),b.hotkeys.add(a.next_key,a.hotkeys_opts,
function(){return l("next")}),b.hotkeys.add(a.mark_key,a.hotkeys_opts,u),b.each(f,function(){var c,d;b.isFunction(this[1])?(c=this[1],d=this[0],b.hotkeys.add(d,a.hotkeys_opts,function(a){return c(a,b.table_hotkeys.current_row)})):(d=this,b.hotkeys.add(d,a.hotkeys_opts,w("."+a.class_prefix+d)))}))};b.table_hotkeys.current_row=null;b.table_hotkeys.defaults={cycle_expr:"tr",class_prefix:"vim-",selected_suffix:"current",destructive_suffix:"destructive",hotkeys_opts:{disableInInput:!0,type:"keypress"},
checkbox_expr:":checkbox",next_key:"j",prev_key:"k",mark_key:"x",start_row_index:2,highlight_first:!1,highlight_last:!1,next_page_link_cb:!1,prev_page_link_cb:!1}})(jQuery);
