(function(d){var g=0,f=9999;d.widget("wp.pointer",{options:{pointerClass:"wp-pointer",pointerWidth:320,content:function(){return d(this).text()},buttons:function(a,b){return d('<a class="close" href="#">'+(wpPointerL10n?wpPointerL10n.dismiss:"Dismiss")+"</a>").bind("click.pointer",function(a){a.preventDefault();b.element.pointer("close")})},position:"top",show:function(a,b){b.pointer.show();b.opened()},hide:function(a,b){b.pointer.hide();b.closed()},document:document},_create:function(){var a,b;this.content=
d('<div class="wp-pointer-content"></div>');this.arrow=d('<div class="wp-pointer-arrow"><div class="wp-pointer-arrow-inner"></div></div>');b=this.element.parents().add(this.element);a="absolute";b.filter(function(){return"fixed"===d(this).css("position")}).length&&(a="fixed");this.pointer=d("<div />").append(this.content).append(this.arrow).attr("id","wp-pointer-"+g++).addClass(this.options.pointerClass).css({position:a,width:this.options.pointerWidth+"px",display:"none"}).appendTo(this.options.document.body)},
_setOption:function(a,b){var c=this.options,e=this.pointer;"document"===a&&b!==c.document?e.detach().appendTo(b.body):"pointerClass"===a&&e.removeClass(c.pointerClass).addClass(b);d.Widget.prototype._setOption.apply(this,arguments);"position"===a?this.reposition():"content"===a&&this.active&&this.update()},destroy:function(){this.pointer.remove();d.Widget.prototype.destroy.call(this)},widget:function(){return this.pointer},update:function(a){var b=this,c=this.options,e=d.Deferred();if(!c.disabled)return e.done(function(c){b._update(a,
c)}),(c="string"===typeof c.content?c.content:c.content.call(this.element[0],e.resolve,a,this._handoff()))&&e.resolve(c),e.promise()},_update:function(a,b){var c;c=this.options;b&&(this.pointer.stop(),this.content.html(b),(c=c.buttons.call(this.element[0],a,this._handoff()))&&c.wrap('<div class="wp-pointer-buttons" />').parent().appendTo(this.content),this.reposition())},reposition:function(){var a;this.options.disabled||(a=this._processPosition(this.options.position),this.pointer.css({top:0,left:0,
zIndex:f++}).show().position(d.extend({of:this.element,collision:"fit none"},a)),this.repoint())},repoint:function(){var a=this.options;a.disabled||(a="string"==typeof a.position?a.position:a.position.edge,this.pointer[0].className=this.pointer[0].className.replace(/wp-pointer-[^\s'"]*/,""),this.pointer.addClass("wp-pointer-"+a))},_processPosition:function(a){var b={top:"bottom",bottom:"top",left:"right",right:"left"};a="string"==typeof a?{edge:a+""}:d.extend({},a);if(!a.edge)return a;"top"==a.edge||
"bottom"==a.edge?(a.align=a.align||"left",a.at=a.at||a.align+" "+b[a.edge],a.my=a.my||a.align+" "+a.edge):(a.align=a.align||"top",a.at=a.at||b[a.edge]+" "+a.align,a.my=a.my||a.edge+" "+a.align);return a},open:function(a){var b=this,c=this.options;this.active||c.disabled||this.element.is(":hidden")||this.update().done(function(){b._open(a)})},_open:function(a){var b=this,c=this.options;this.active||c.disabled||this.element.is(":hidden")||(this.active=!0,this._trigger("open",a,this._handoff()),this._trigger("show",
a,this._handoff({opened:function(){b._trigger("opened",a,b._handoff())}})))},close:function(a){if(this.active&&!this.options.disabled){var b=this;this.active=!1;this._trigger("close",a,this._handoff());this._trigger("hide",a,this._handoff({closed:function(){b._trigger("closed",a,b._handoff())}}))}},sendToTop:function(){this.active&&this.pointer.css("z-index",f++)},toggle:function(a){this.pointer.is(":hidden")?this.open(a):this.close(a)},_handoff:function(a){return d.extend({pointer:this.pointer,element:this.element},
a)}})})(jQuery);
