(function e$$0(f,g,d){function c(a,m){if(!g[a]){if(!f[a]){var h="function"==typeof require&&require;if(!m&&h)return h(a,!0);if(b)return b(a,!0);h=Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h;}h=g[a]={exports:{}};f[a][0].call(h.exports,function(b){var d=f[a][1][b];return c(d?d:b)},h,h.exports,e$$0,f,g,d)}return g[a].exports}for(var b="function"==typeof require&&require,a=0;a<d.length;a++)c(d[a]);return c})({1:[function(e,f,g){var d=wp.media.model.Selection,c=wp.media.controller.Library;
e=c.extend({defaults:_.defaults({multiple:"add",filterable:"uploaded",priority:100,syncSelection:!1},c.prototype.defaults),initialize:function(){var b=this.get("collectionType");"video"===this.get("type")&&(b="video-"+b);this.set("id",b+"-library");this.set("toolbar",b+"-add");this.set("menu",b);this.get("library")||this.set("library",wp.media.query({type:this.get("type")}));c.prototype.initialize.apply(this,arguments)},activate:function(){var b=this.get("library"),a=this.get("editLibrary"),e=this.frame.state(this.get("collectionType")+
"-edit").get("library");a&&a!==e&&b.unobserve(a);b.validator=function(a){return!!this.mirroring.get(a.cid)&&!e.get(a.cid)&&d.prototype.validator.apply(this,arguments)};b.reset(b.mirroring.models,{silent:!0});b.observe(e);this.set("editLibrary",e);c.prototype.activate.apply(this,arguments)}});f.exports=e},{}],2:[function(e,f,g){var d=wp.media.controller.Library,c=wp.media.view.l10n,b=jQuery;e=d.extend({defaults:{multiple:!1,sortable:!0,date:!1,searchable:!1,content:"browse",describe:!0,dragInfo:!0,
idealColumnWidth:170,editing:!1,priority:60,SettingsView:!1,syncSelection:!1},initialize:function(){var a=this.get("collectionType");"video"===this.get("type")&&(a="video-"+a);this.set("id",a+"-edit");this.set("toolbar",a+"-edit");this.get("library")||this.set("library",new wp.media.model.Selection);this.get("AttachmentView")||this.set("AttachmentView",wp.media.view.Attachment.EditLibrary);d.prototype.initialize.apply(this,arguments)},activate:function(){this.get("library").props.set("type",this.get("type"));
this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.renderSettings,this);d.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.renderSettings,this);d.prototype.deactivate.apply(this,arguments)},renderSettings:function(a){var d=this.get("library"),e=this.get("collectionType"),f=this.get("dragInfoText"),g=this.get("SettingsView"),k={};d&&a&&(d[e]=d[e]||new Backbone.Model,
k[e]=new g({controller:this,model:d[e],priority:40}),a.sidebar.set(k),f&&a.toolbar.set("dragInfo",new wp.media.View({el:b('<div class="instructions">'+f+"</div>")[0],priority:-40})),a.toolbar.set("reverse",{text:c.reverseOrder,priority:80,click:function(){d.reset(d.toArray().reverse())}}))}});f.exports=e},{}],3:[function(e,f,g){var d=wp.media.view.l10n;e=wp.media.controller.State.extend({defaults:{id:"cropper",title:d.cropImage,toolbar:"crop",content:"crop",router:!1,canSkipCrop:!1},activate:function(){this.frame.on("content:create:crop",
this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},deactivate:function(){this.frame.toolbar.mode("browse")},createCropContent:function(){this.cropperView=new wp.media.view.Cropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},removeCropper:function(){this.imgSelect.cancelSelection();
this.imgSelect.setOptions({remove:!0});this.imgSelect.update();this.cropperView.remove()},createCropToolbar:function(){var c,b;c=this.get("canSkipCrop")||!1;b={controller:this.frame,items:{insert:{style:"primary",text:d.cropImage,priority:80,requires:{library:!1,selection:!1},click:function(){var a=this.controller,b;b=a.state().get("selection").first();b.set({cropDetails:a.state().imgSelect.getSelection()});this.$el.text(d.cropping);this.$el.attr("disabled",!0);a.state().doCrop(b).done(function(b){a.trigger("cropped",
b);a.close()}).fail(function(){a.trigger("content:error:crop")})}}}};c&&_.extend(b.items,{skip:{style:"secondary",text:d.skipCropping,priority:70,requires:{library:!1,selection:!1},click:function(){var a=this.controller.state().get("selection").first();this.controller.state().cropperView.remove();this.controller.trigger("skippedcrop",a);this.controller.close()}}});this.frame.toolbar.set(new wp.media.view.Toolbar(b))},doCrop:function(c){return wp.ajax.post("custom-header-crop",{nonce:c.get("nonces").edit,
id:c.get("id"),cropDetails:c.get("cropDetails")})}});f.exports=e},{}],4:[function(e,f,g){e=wp.media.controller.Cropper.extend({doCrop:function(d){var c=d.get("cropDetails"),b=this.get("control");c.dst_width=b.params.width;c.dst_height=b.params.height;return wp.ajax.post("crop-image",{wp_customize:"on",nonce:d.get("nonces").edit,id:d.get("id"),context:b.id,cropDetails:c})}});f.exports=e},{}],5:[function(e,f,g){var d=wp.media.view.l10n;e=wp.media.controller.State.extend({defaults:{id:"edit-image",title:d.editImage,
menu:!1,toolbar:"edit-image",content:"edit-image",url:""},activate:function(){this.listenTo(this.frame,"toolbar:render:edit-image",this.toolbar)},deactivate:function(){this.stopListening(this.frame)},toolbar:function(){var c=this.frame,b=c.lastState(),a=b&&b.id;c.toolbar.set(new wp.media.view.Toolbar({controller:c,items:{back:{style:"primary",text:d.back,priority:20,click:function(){a?c.setState(a):c.close()}}}}))}});f.exports=e},{}],6:[function(e,f,g){var d=Backbone.$;e=wp.media.controller.State.extend({defaults:{id:"embed",
title:wp.media.view.l10n.insertFromUrlTitle,content:"embed",menu:"default",toolbar:"main-embed",priority:120,type:"link",url:"",metadata:{}},sensitivity:400,initialize:function(c){this.metadata=c.metadata;this.debouncedScan=_.debounce(_.bind(this.scan,this),this.sensitivity);this.props=new Backbone.Model(this.metadata||{url:""});this.props.on("change:url",this.debouncedScan,this);this.props.on("change:url",this.refresh,this);this.on("scan",this.scanImage,this)},scan:function(){var c,b=this,a={type:"link",
scanners:[]};this.props.get("url")&&this.trigger("scan",a);a.scanners.length?(c=a.scanners=d.when.apply(d,a.scanners),c.always(function(){b.get("scanners")===c&&b.set("loading",!1)})):a.scanners=null;a.loading=!!a.scanners;this.set(a)},scanImage:function(c){var b=this.frame,a=this,e=this.props.get("url"),f=new Image,h=d.Deferred();c.scanners.push(h.promise());f.onload=function(){h.resolve();a===b.state()&&e===a.props.get("url")&&(a.set({type:"image"}),a.props.set({width:f.width,height:f.height}))};
f.onerror=h.reject;f.src=e},refresh:function(){this.frame.toolbar.get().refresh()},reset:function(){this.props.clear().set({url:""});this.active&&this.refresh()}});f.exports=e},{}],7:[function(e,f,g){var d=wp.media.model.Attachment,c=wp.media.controller.Library;e=c.extend({defaults:_.defaults({id:"featured-image",title:wp.media.view.l10n.setFeaturedImageTitle,multiple:!1,filterable:"uploaded",toolbar:"featured-image",priority:60,syncSelection:!0},c.prototype.defaults),initialize:function(){var b,
a;this.get("library")||this.set("library",wp.media.query({type:"image"}));c.prototype.initialize.apply(this,arguments);b=this.get("library");a=b.comparator;b.comparator=function(b,c){var d=!!this.mirroring.get(b.cid),e=!!this.mirroring.get(c.cid);return!d&&e?-1:d&&!e?1:a.apply(this,arguments)};b.observe(this.get("selection"))},activate:function(){this.updateSelection();this.frame.on("open",this.updateSelection,this);c.prototype.activate.apply(this,arguments)},deactivate:function(){this.frame.off("open",
this.updateSelection,this);c.prototype.deactivate.apply(this,arguments)},updateSelection:function(){var b=this.get("selection"),a=wp.media.view.settings.post.featuredImageId,c;""!==a&&-1!==a&&(c=d.get(a),c.fetch());b.reset(c?[c]:[])}});f.exports=e},{}],8:[function(e,f,g){var d=wp.media.model.Selection,c=wp.media.controller.Library;e=c.extend({defaults:_.defaults({id:"gallery-library",title:wp.media.view.l10n.addToGalleryTitle,multiple:"add",filterable:"uploaded",menu:"gallery",toolbar:"gallery-add",
priority:100,syncSelection:!1},c.prototype.defaults),initialize:function(){this.get("library")||this.set("library",wp.media.query({type:"image"}));c.prototype.initialize.apply(this,arguments)},activate:function(){var b=this.get("library"),a=this.frame.state("gallery-edit").get("library");this.editLibrary&&this.editLibrary!==a&&b.unobserve(this.editLibrary);b.validator=function(b){return!!this.mirroring.get(b.cid)&&!a.get(b.cid)&&d.prototype.validator.apply(this,arguments)};b.reset(b.mirroring.models,
{silent:!0});b.observe(a);this.editLibrary=a;c.prototype.activate.apply(this,arguments)}});f.exports=e},{}],9:[function(e,f,g){var d=wp.media.controller.Library,c=wp.media.view.l10n;e=d.extend({defaults:{id:"gallery-edit",title:c.editGalleryTitle,multiple:!1,searchable:!1,sortable:!0,date:!1,display:!1,content:"browse",toolbar:"gallery-edit",describe:!0,displaySettings:!0,dragInfo:!0,idealColumnWidth:170,editing:!1,priority:60,syncSelection:!1},initialize:function(){this.get("library")||this.set("library",
new wp.media.model.Selection);this.get("AttachmentView")||this.set("AttachmentView",wp.media.view.Attachment.EditLibrary);d.prototype.initialize.apply(this,arguments)},activate:function(){this.get("library").props.set("type","image");this.get("library").observe(wp.Uploader.queue);this.frame.on("content:render:browse",this.gallerySettings,this);d.prototype.activate.apply(this,arguments)},deactivate:function(){this.get("library").unobserve(wp.Uploader.queue);this.frame.off("content:render:browse",this.gallerySettings,
this);d.prototype.deactivate.apply(this,arguments)},gallerySettings:function(b){if(this.get("displaySettings")){var a=this.get("library");a&&b&&(a.gallery=a.gallery||new Backbone.Model,b.sidebar.set({gallery:new wp.media.view.Settings.Gallery({controller:this,model:a.gallery,priority:40})}),b.toolbar.set("reverse",{text:c.reverseOrder,priority:80,click:function(){a.reset(a.toArray().reverse())}}))}}});f.exports=e},{}],10:[function(e,f,g){var d=wp.media.controller.State;e=d.extend({defaults:_.defaults({id:"image-details",
title:wp.media.view.l10n.imageDetailsTitle,content:"image-details",menu:!1,router:!1,toolbar:"image-details",editing:!1,priority:60},wp.media.controller.Library.prototype.defaults),initialize:function(c){this.image=c.image;d.prototype.initialize.apply(this,arguments)},activate:function(){this.frame.modal.$el.addClass("image-details")}});f.exports=e},{}],11:[function(e,f,g){var d=window.getUserSetting,c=window.setUserSetting;e=wp.media.controller.State.extend({defaults:{id:"library",title:wp.media.view.l10n.mediaLibraryTitle,
multiple:!1,content:"upload",menu:"default",router:"browse",toolbar:"select",searchable:!0,filterable:!1,sortable:!0,autoSelect:!0,describe:!1,contentUserSetting:!0,syncSelection:!0},initialize:function(){var b=this.get("selection");this.get("library")||this.set("library",wp.media.query());b instanceof wp.media.model.Selection||(b||(b=this.get("library").props.toJSON(),b=_.omit(b,"orderby","query")),this.set("selection",new wp.media.model.Selection(null,{multiple:this.get("multiple"),props:b})));
this.resetDisplays()},activate:function(){this.syncSelection();wp.Uploader.queue.on("add",this.uploading,this);this.get("selection").on("add remove reset",this.refreshContent,this);this.get("router")&&this.get("contentUserSetting")&&(this.frame.on("content:activate",this.saveContentMode,this),this.set("content",d("libraryContent",this.get("content"))))},deactivate:function(){this.recordSelection();this.frame.off("content:activate",this.saveContentMode,this);this.get("selection").off(null,null,this);
wp.Uploader.queue.off(null,null,this)},reset:function(){this.get("selection").reset();this.resetDisplays();this.refreshContent()},resetDisplays:function(){var b=wp.media.view.settings.defaultProps;this._displays=[];this._defaultDisplaySettings={align:b.align||d("align","none"),size:b.size||d("imgsize","medium"),link:b.link||d("urlbutton","file")}},display:function(b){var a=this._displays;a[b.cid]||(a[b.cid]=new Backbone.Model(this.defaultDisplaySettings(b)));return a[b.cid]},defaultDisplaySettings:function(b){var a=
this._defaultDisplaySettings;if(a.canEmbed=this.canEmbed(b))a.link="embed";return a},canEmbed:function(b){if(!b.get("uploading")){var a=b.get("type");if("audio"!==a&&"video"!==a)return!1}return _.contains(wp.media.view.settings.embedExts,b.get("filename").split(".").pop())},refreshContent:function(){var b=this.get("selection"),a=this.frame,c=a.router.get(),a=a.content.mode();this.active&&!b.length&&c&&!c.get(a)&&this.frame.content.render(this.get("content"))},uploading:function(b){"upload"===this.frame.content.mode()&&
this.frame.content.mode("browse");this.get("autoSelect")&&(this.get("selection").add(b),this.frame.trigger("library:selection:add"))},saveContentMode:function(){if("browse"===this.get("router")){var b=this.frame.content.mode(),a=this.frame.router.get();a&&a.get(b)&&c("libraryContent",b)}}});_.extend(e.prototype,wp.media.selectionSync);f.exports=e},{}],12:[function(e,f,g){var d=wp.media.controller.Library;e=d.extend({defaults:_.defaults({filterable:"uploaded",displaySettings:!1,priority:80,syncSelection:!1},
d.prototype.defaults),initialize:function(c){this.media=c.media;this.type=c.type;this.set("library",wp.media.query({type:this.type}));d.prototype.initialize.apply(this,arguments)},activate:function(){wp.media.frame.lastMime&&(this.set("library",wp.media.query({type:wp.media.frame.lastMime})),delete wp.media.frame.lastMime);d.prototype.activate.apply(this,arguments)}});f.exports=e},{}],13:[function(e,f,g){e=function(d){_.extend(this,_.pick(d||{},"id","view","selector"))};e.extend=Backbone.Model.extend;
_.extend(e.prototype,{mode:function(d){if(!d)return this._mode;if(d===this._mode)return this;this.trigger("deactivate");this._mode=d;this.render(d);this.trigger("activate");return this},render:function(d){if(d&&d!==this._mode)return this.mode(d);d={view:null};this.trigger("create",d);d=d.view;this.trigger("render",d);d&&this.set(d);return this},get:function(){return this.view.views.first(this.selector)},set:function(d,c){c&&(c.add=!1);return this.view.views.set(this.selector,d,c)},trigger:function(d){var c,
b;if(this._mode)return b=_.toArray(arguments),c=this.id+":"+d,b[0]=c+":"+this._mode,this.view.trigger.apply(this.view,b),b[0]=c,this.view.trigger.apply(this.view,b),this}});f.exports=e},{}],14:[function(e,f,g){var d=wp.media.controller.Library;e=d.extend({defaults:_.defaults({id:"replace-image",title:wp.media.view.l10n.replaceImageTitle,multiple:!1,filterable:"uploaded",toolbar:"replace",menu:!1,priority:60,syncSelection:!0},d.prototype.defaults),initialize:function(c){var b,a;this.image=c.image;
this.get("library")||this.set("library",wp.media.query({type:"image"}));d.prototype.initialize.apply(this,arguments);b=this.get("library");a=b.comparator;b.comparator=function(b,c){var d=!!this.mirroring.get(b.cid),e=!!this.mirroring.get(c.cid);return!d&&e?-1:d&&!e?1:a.apply(this,arguments)};b.observe(this.get("selection"))},activate:function(){this.updateSelection();d.prototype.activate.apply(this,arguments)},updateSelection:function(){var c=this.get("selection"),b=this.image.attachment;c.reset(b?
[b]:[])}});f.exports=e},{}],15:[function(e,f,g){e=wp.media.controller.Cropper.extend({activate:function(){this.frame.on("content:create:crop",this.createCropContent,this);this.frame.on("close",this.removeCropper,this);this.set("selection",new Backbone.Collection(this.frame._selection.single))},createCropContent:function(){this.cropperView=new wp.media.view.SiteIconCropper({controller:this,attachment:this.get("selection").first()});this.cropperView.on("image-loaded",this.createCropToolbar,this);this.frame.content.set(this.cropperView)},
doCrop:function(d){var c=d.get("cropDetails"),b=this.get("control");c.dst_width=b.params.width;c.dst_height=b.params.height;return wp.ajax.post("crop-image",{nonce:d.get("nonces").edit,id:d.get("id"),context:"site-icon",cropDetails:c})}});f.exports=e},{}],16:[function(e,f,g){var d=function(c){this.states=new Backbone.Collection(c)};d.extend=Backbone.Model.extend;_.extend(d.prototype,Backbone.Events,{state:function(c){this.states=this.states||new Backbone.Collection;(c=c||this._state)&&!this.states.get(c)&&
this.states.add({id:c});return this.states.get(c)},setState:function(c){var b=this.state();if(b&&c===b.id||!this.states||!this.states.get(c))return this;b&&(b.trigger("deactivate"),this._lastState=b.id);this._state=c;this.state().trigger("activate");return this},lastState:function(){if(this._lastState)return this.state(this._lastState)}});_.each(["on","off","trigger"],function(c){d.prototype[c]=function(){this.states=this.states||new Backbone.Collection;this.states[c].apply(this.states,arguments);
return this}});f.exports=d},{}],17:[function(e,f,g){var d=Backbone.Model.extend({constructor:function(){this.on("activate",this._preActivate,this);this.on("activate",this.activate,this);this.on("activate",this._postActivate,this);this.on("deactivate",this._deactivate,this);this.on("deactivate",this.deactivate,this);this.on("reset",this.reset,this);this.on("ready",this._ready,this);this.on("ready",this.ready,this);Backbone.Model.apply(this,arguments);this.on("change:menu",this._updateMenu,this)},ready:function(){},
activate:function(){},deactivate:function(){},reset:function(){},_ready:function(){this._updateMenu()},_preActivate:function(){this.active=!0},_postActivate:function(){this.on("change:menu",this._menu,this);this.on("change:titleMode",this._title,this);this.on("change:content",this._content,this);this.on("change:toolbar",this._toolbar,this);this.frame.on("title:render:default",this._renderTitle,this);this._title();this._menu();this._toolbar();this._content();this._router()},_deactivate:function(){this.active=
!1;this.frame.off("title:render:default",this._renderTitle,this);this.off("change:menu",this._menu,this);this.off("change:titleMode",this._title,this);this.off("change:content",this._content,this);this.off("change:toolbar",this._toolbar,this)},_title:function(){this.frame.title.render(this.get("titleMode")||"default")},_renderTitle:function(c){c.$el.text(this.get("title")||"")},_router:function(){var c=this.frame.router,b=this.get("router");this.frame.$el.toggleClass("hide-router",!b);b&&(this.frame.router.render(b),
(c=c.get())&&c.select&&c.select(this.frame.content.mode()))},_menu:function(){var c=this.frame.menu,b=this.get("menu");this.frame.$el.toggleClass("hide-menu",!b);b&&(c.mode(b),(c=c.get())&&c.select&&c.select(this.id))},_updateMenu:function(){var c=this.previous("menu"),b=this.get("menu");c&&this.frame.off("menu:render:"+c,this._renderMenu,this);if(b)this.frame.on("menu:render:"+b,this._renderMenu,this)},_renderMenu:function(c){var b=this.get("menuItem"),a=this.get("title"),d=this.get("priority");
!b&&a&&(b={text:a},d&&(b.priority=d));b&&c.set(this.id,b)}});_.each(["toolbar","content"],function(c){d.prototype["_"+c]=function(){var b=this.get(c);b&&this.frame[c].render(b)}});f.exports=d},{}],18:[function(e,f,g){f.exports={syncSelection:function(){var d=this.get("selection"),c=this.frame._selection;this.get("syncSelection")&&c&&d&&(d.multiple&&(d.reset([],{silent:!0}),d.validateAll(c.attachments),c.difference=_.difference(c.attachments.models,d.models)),d.single(c.single))},recordSelection:function(){var d=
this.get("selection"),c=this.frame._selection;this.get("syncSelection")&&c&&d&&(d.multiple?(c.attachments.reset(d.toArray().concat(c.difference)),c.difference=[]):c.attachments.add(d.toArray()),c.single=d._single)}}},{}],19:[function(e,f,g){f=wp.media;var d=jQuery;f.isTouchDevice="ontouchend"in document;g=f.view.l10n=window._wpMediaViewsL10n||{};f.view.settings=g.settings||{};delete g.settings;f.model.settings.post=f.view.settings.post;d.support.transition=function(){var c=document.documentElement.style,
b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},a;return(a=_.find(_.keys(b),function(a){return!_.isUndefined(c[a])}))&&{end:b[a]}}();f.events=_.extend({},Backbone.Events);f.transition=function(c,b){var a=d.Deferred();b=b||2E3;d.support.transition?(c instanceof d||(c=d(c)),c.first().one(d.support.transition.end,a.resolve),_.delay(a.resolve,b)):a.resolve();return a.promise()};f.controller.Region=e("./controllers/region.js");
f.controller.StateMachine=e("./controllers/state-machine.js");f.controller.State=e("./controllers/state.js");f.selectionSync=e("./utils/selection-sync.js");f.controller.Library=e("./controllers/library.js");f.controller.ImageDetails=e("./controllers/image-details.js");f.controller.GalleryEdit=e("./controllers/gallery-edit.js");f.controller.GalleryAdd=e("./controllers/gallery-add.js");f.controller.CollectionEdit=e("./controllers/collection-edit.js");f.controller.CollectionAdd=e("./controllers/collection-add.js");
f.controller.FeaturedImage=e("./controllers/featured-image.js");f.controller.ReplaceImage=e("./controllers/replace-image.js");f.controller.EditImage=e("./controllers/edit-image.js");f.controller.MediaLibrary=e("./controllers/media-library.js");f.controller.Embed=e("./controllers/embed.js");f.controller.Cropper=e("./controllers/cropper.js");f.controller.CustomizeImageCropper=e("./controllers/customize-image-cropper.js");f.controller.SiteIconCropper=e("./controllers/site-icon-cropper.js");f.View=e("./views/view.js");
f.view.Frame=e("./views/frame.js");f.view.MediaFrame=e("./views/media-frame.js");f.view.MediaFrame.Select=e("./views/frame/select.js");f.view.MediaFrame.Post=e("./views/frame/post.js");f.view.MediaFrame.ImageDetails=e("./views/frame/image-details.js");f.view.Modal=e("./views/modal.js");f.view.FocusManager=e("./views/focus-manager.js");f.view.UploaderWindow=e("./views/uploader/window.js");f.view.EditorUploader=e("./views/uploader/editor.js");f.view.UploaderInline=e("./views/uploader/inline.js");f.view.UploaderStatus=
e("./views/uploader/status.js");f.view.UploaderStatusError=e("./views/uploader/status-error.js");f.view.Toolbar=e("./views/toolbar.js");f.view.Toolbar.Select=e("./views/toolbar/select.js");f.view.Toolbar.Embed=e("./views/toolbar/embed.js");f.view.Button=e("./views/button.js");f.view.ButtonGroup=e("./views/button-group.js");f.view.PriorityList=e("./views/priority-list.js");f.view.MenuItem=e("./views/menu-item.js");f.view.Menu=e("./views/menu.js");f.view.RouterItem=e("./views/router-item.js");f.view.Router=
e("./views/router.js");f.view.Sidebar=e("./views/sidebar.js");f.view.Attachment=e("./views/attachment.js");f.view.Attachment.Library=e("./views/attachment/library.js");f.view.Attachment.EditLibrary=e("./views/attachment/edit-library.js");f.view.Attachments=e("./views/attachments.js");f.view.Search=e("./views/search.js");f.view.AttachmentFilters=e("./views/attachment-filters.js");f.view.DateFilter=e("./views/attachment-filters/date.js");f.view.AttachmentFilters.Uploaded=e("./views/attachment-filters/uploaded.js");
f.view.AttachmentFilters.All=e("./views/attachment-filters/all.js");f.view.AttachmentsBrowser=e("./views/attachments/browser.js");f.view.Selection=e("./views/selection.js");f.view.Attachment.Selection=e("./views/attachment/selection.js");f.view.Attachments.Selection=e("./views/attachments/selection.js");f.view.Attachment.EditSelection=e("./views/attachment/edit-selection.js");f.view.Settings=e("./views/settings.js");f.view.Settings.AttachmentDisplay=e("./views/settings/attachment-display.js");f.view.Settings.Gallery=
e("./views/settings/gallery.js");f.view.Settings.Playlist=e("./views/settings/playlist.js");f.view.Attachment.Details=e("./views/attachment/details.js");f.view.AttachmentCompat=e("./views/attachment-compat.js");f.view.Iframe=e("./views/iframe.js");f.view.Embed=e("./views/embed.js");f.view.Label=e("./views/label.js");f.view.EmbedUrl=e("./views/embed/url.js");f.view.EmbedLink=e("./views/embed/link.js");f.view.EmbedImage=e("./views/embed/image.js");f.view.ImageDetails=e("./views/image-details.js");f.view.Cropper=
e("./views/cropper.js");f.view.SiteIconCropper=e("./views/site-icon-cropper.js");f.view.SiteIconPreview=e("./views/site-icon-preview.js");f.view.EditImage=e("./views/edit-image.js");f.view.Spinner=e("./views/spinner.js")},{"./controllers/collection-add.js":1,"./controllers/collection-edit.js":2,"./controllers/cropper.js":3,"./controllers/customize-image-cropper.js":4,"./controllers/edit-image.js":5,"./controllers/embed.js":6,"./controllers/featured-image.js":7,"./controllers/gallery-add.js":8,"./controllers/gallery-edit.js":9,
"./controllers/image-details.js":10,"./controllers/library.js":11,"./controllers/media-library.js":12,"./controllers/region.js":13,"./controllers/replace-image.js":14,"./controllers/site-icon-cropper.js":15,"./controllers/state-machine.js":16,"./controllers/state.js":17,"./utils/selection-sync.js":18,"./views/attachment-compat.js":20,"./views/attachment-filters.js":21,"./views/attachment-filters/all.js":22,"./views/attachment-filters/date.js":23,"./views/attachment-filters/uploaded.js":24,"./views/attachment.js":25,
"./views/attachment/details.js":26,"./views/attachment/edit-library.js":27,"./views/attachment/edit-selection.js":28,"./views/attachment/library.js":29,"./views/attachment/selection.js":30,"./views/attachments.js":31,"./views/attachments/browser.js":32,"./views/attachments/selection.js":33,"./views/button-group.js":34,"./views/button.js":35,"./views/cropper.js":36,"./views/edit-image.js":37,"./views/embed.js":38,"./views/embed/image.js":39,"./views/embed/link.js":40,"./views/embed/url.js":41,"./views/focus-manager.js":42,
"./views/frame.js":43,"./views/frame/image-details.js":44,"./views/frame/post.js":45,"./views/frame/select.js":46,"./views/iframe.js":47,"./views/image-details.js":48,"./views/label.js":49,"./views/media-frame.js":50,"./views/menu-item.js":51,"./views/menu.js":52,"./views/modal.js":53,"./views/priority-list.js":54,"./views/router-item.js":55,"./views/router.js":56,"./views/search.js":57,"./views/selection.js":58,"./views/settings.js":59,"./views/settings/attachment-display.js":60,"./views/settings/gallery.js":61,
"./views/settings/playlist.js":62,"./views/sidebar.js":63,"./views/site-icon-cropper.js":64,"./views/site-icon-preview.js":65,"./views/spinner.js":66,"./views/toolbar.js":67,"./views/toolbar/embed.js":68,"./views/toolbar/select.js":69,"./views/uploader/editor.js":70,"./views/uploader/inline.js":71,"./views/uploader/status-error.js":72,"./views/uploader/status.js":73,"./views/uploader/window.js":74,"./views/view.js":75}],20:[function(e,f,g){var d=wp.media.View;e=d.extend({tagName:"form",className:"compat-item",
events:{submit:"preventDefault","change input":"save","change select":"save","change textarea":"save"},initialize:function(){this.listenTo(this.model,"change:compat",this.render)},dispose:function(){this.$(":focus").length&&this.save();return d.prototype.dispose.apply(this,arguments)},render:function(){var c=this.model.get("compat");if(c&&c.item)return this.views.detach(),this.$el.html(c.item),this.views.render(),this},preventDefault:function(c){c.preventDefault()},save:function(c){var b={};c&&c.preventDefault();
_.each(this.$el.serializeArray(),function(a){b[a.name]=a.value});this.controller.trigger("attachment:compat:waiting",["waiting"]);this.model.saveCompat(b).always(_.bind(this.postSave,this))},postSave:function(){this.controller.trigger("attachment:compat:ready",["ready"])}});f.exports=e},{}],21:[function(e,f,g){var d=jQuery;e=wp.media.View.extend({tagName:"select",className:"attachment-filters",id:"media-attachment-filters",events:{change:"change"},keys:[],initialize:function(){this.createFilters();
_.extend(this.filters,this.options.filters);this.$el.html(_.chain(this.filters).map(function(c,b){return{el:d("<option></option>").val(b).html(c.text)[0],priority:c.priority||50}},this).sortBy("priority").pluck("el").value());this.listenTo(this.model,"change",this.select);this.select()},createFilters:function(){this.filters={}},change:function(){var c=this.filters[this.el.value];c&&this.model.set(c.props)},select:function(){var c="all",b=this.model.toJSON();_.find(this.filters,function(a,d){if(_.all(a.props,
function(a,c){return a===(_.isUndefined(b[c])?null:b[c])}))return c=d});this.$el.val(c)}});f.exports=e},{}],22:[function(e,f,g){var d=wp.media.view.l10n;e=wp.media.view.AttachmentFilters.extend({createFilters:function(){var c={};_.each(wp.media.view.settings.mimeTypes||{},function(b,a){c[a]={text:b,props:{status:null,type:a,uploadedTo:null,orderby:"date",order:"DESC"}}});c.all={text:d.allMediaItems,props:{status:null,type:null,uploadedTo:null,orderby:"date",order:"DESC"},priority:10};wp.media.view.settings.post.id&&
(c.uploaded={text:d.uploadedToThisPost,props:{status:null,type:null,uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20});c.unattached={text:d.unattached,props:{status:null,uploadedTo:0,type:null,orderby:"menuOrder",order:"ASC"},priority:50};wp.media.view.settings.mediaTrash&&this.controller.isModeActive("grid")&&(c.trash={text:d.trash,props:{uploadedTo:null,status:"trash",type:null,orderby:"date",order:"DESC"},priority:50});this.filters=c}});f.exports=e},{}],23:[function(e,
f,g){var d=wp.media.view.l10n;e=wp.media.view.AttachmentFilters.extend({id:"media-attachment-date-filters",createFilters:function(){var c={};_.each(wp.media.view.settings.months||{},function(b,a){c[a]={text:b.text,props:{year:b.year,monthnum:b.month}}});c.all={text:d.allDates,props:{monthnum:!1,year:!1},priority:10};this.filters=c}});f.exports=e},{}],24:[function(e,f,g){var d=wp.media.view.l10n;e=wp.media.view.AttachmentFilters.extend({createFilters:function(){var c=this.model.get("type"),b=wp.media.view.settings.mimeTypes,
a;b&&c&&(a=b[c]);this.filters={all:{text:a||d.allMediaItems,props:{uploadedTo:null,orderby:"date",order:"DESC"},priority:10},uploaded:{text:d.uploadedToThisPost,props:{uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20},unattached:{text:d.unattached,props:{uploadedTo:0,orderby:"menuOrder",order:"ASC"},priority:50}}}});f.exports=e},{}],25:[function(e,f,g){var d=wp.media.View,c=jQuery,b;b=d.extend({tagName:"li",className:"attachment",template:wp.template("attachment"),
attributes:function(){return{tabIndex:0,role:"checkbox","aria-label":this.model.get("title"),"aria-checked":!1,"data-id":this.model.get("id")}},events:{"click .js--select-attachment":"toggleSelectionHandler","change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .attachment-close":"removeFromLibrary","click .check":"checkClickHandler",keydown:"toggleSelectionHandler"},
buttons:{},initialize:function(){var a=this.options.selection;_.defaults(this.options,{rerenderOnModelChange:!0}).rerenderOnModelChange?this.listenTo(this.model,"change",this.render):this.listenTo(this.model,"change:percent",this.progress);this.listenTo(this.model,"change:title",this._syncTitle);this.listenTo(this.model,"change:caption",this._syncCaption);this.listenTo(this.model,"change:artist",this._syncArtist);this.listenTo(this.model,"change:album",this._syncAlbum);this.listenTo(this.model,"add",
this.select);this.listenTo(this.model,"remove",this.deselect);a&&(a.on("reset",this.updateSelect,this),this.listenTo(this.model,"selection:single selection:unsingle",this.details),this.details(this.model,this.controller.state().get("selection")));this.listenTo(this.controller,"attachment:compat:waiting attachment:compat:ready",this.updateSave)},dispose:function(){var a=this.options.selection;this.updateAll();a&&a.off(null,null,this);d.prototype.dispose.apply(this,arguments);return this},render:function(){var a=
_.defaults(this.model.toJSON(),{orientation:"landscape",uploading:!1,type:"",subtype:"",icon:"",filename:"",caption:"",title:"",dateFormatted:"",width:"",height:"",compat:!1,alt:"",description:""},this.options);a.buttons=this.buttons;a.describe=this.controller.state().get("describe");"image"===a.type&&(a.size=this.imageSize());a.can={};a.nonces&&(a.can.remove=!!a.nonces["delete"],a.can.save=!!a.nonces.update);this.controller.state().get("allowLocalEdits")&&(a.allowLocalEdits=!0);a.uploading&&!a.percent&&
(a.percent=0);this.views.detach();this.$el.html(this.template(a));this.$el.toggleClass("uploading",a.uploading);a.uploading?this.$bar=this.$(".media-progress-bar div"):delete this.$bar;this.updateSelect();this.updateSave();this.views.render();return this},progress:function(){this.$bar&&this.$bar.length&&this.$bar.width(this.model.get("percent")+"%")},toggleSelectionHandler:function(a){var b;if("INPUT"!==a.target.nodeName&&"BUTTON"!==a.target.nodeName)if(37===a.keyCode||38===a.keyCode||39===a.keyCode||
40===a.keyCode)this.controller.trigger("attachment:keydown:arrow",a);else if("keydown"!==a.type||13===a.keyCode||32===a.keyCode){a.preventDefault();if(this.controller.isModeActive("grid")){if(this.controller.isModeActive("edit")){this.controller.trigger("edit:attachment",this.model,a.currentTarget);return}this.controller.isModeActive("select")&&(b="toggle")}if(a.shiftKey)b="between";else if(a.ctrlKey||a.metaKey)b="toggle";this.toggleSelection({method:b});this.controller.trigger("selection:toggle")}},
toggleSelection:function(a){var b=this.collection,c=this.options.selection,d=this.model;a=a&&a.method;var e;if(c)if(e=c.single(),a=_.isUndefined(a)?c.multiple:a,"between"===a&&e&&c.multiple)e!==d&&(a=b.indexOf(e),e=b.indexOf(this.model),b=a<e?b.models.slice(a,e+1):b.models.slice(e,a+1),c.add(b),c.single(d));else if("toggle"===a)c[this.selected()?"remove":"add"](d),c.single(d);else if("add"===a)c.add(d),c.single(d);else if(a||(a="add"),"add"!==a&&(a="reset"),this.selected())c[e===d?"remove":"single"](d);
else c[a](d),c.single(d)},updateSelect:function(){this[this.selected()?"select":"deselect"]()},selected:function(){var a=this.options.selection;if(a)return!!a.get(this.model.cid)},select:function(a,b){var c=this.options.selection,d=this.controller;!c||b&&b!==c||this.$el.hasClass("selected")||(this.$el.addClass("selected").attr("aria-checked",!0),d.isModeActive("grid")&&d.isModeActive("select")||this.$(".check").attr("tabindex","0"))},deselect:function(a,b){var c=this.options.selection;!c||b&&b!==
c||this.$el.removeClass("selected").attr("aria-checked",!1).find(".check").attr("tabindex","-1")},details:function(a,b){var c=this.options.selection;c===b&&(c=c.single(),this.$el.toggleClass("details",c===this.model))},imageSize:function(a){var b=this.model.get("sizes"),c=!1;a=a||"medium";return b&&(b[a]?c=b[a]:b.large?c=b.large:b.thumbnail?c=b.thumbnail:b.full&&(c=b.full),c)?_.clone(c):{url:this.model.get("url"),width:this.model.get("width"),height:this.model.get("height"),orientation:this.model.get("orientation")}},
updateSetting:function(a){var b=c(a.target).closest("[data-setting]");b.length&&(b=b.data("setting"),a=a.target.value,this.model.get(b)!==a&&this.save(b,a))},save:function(){var a=this,b=this._save=this._save||{status:"ready"},d=this.model.save.apply(this.model,arguments),e=b.requests?c.when(d,b.requests):d;b.savedTimer&&clearTimeout(b.savedTimer);this.updateSave("waiting");b.requests=e;e.always(function(){b.requests===e&&(a.updateSave("resolved"===e.state()?"complete":"error"),b.savedTimer=setTimeout(function(){a.updateSave("ready");
delete b.savedTimer},2E3))})},updateSave:function(a){var b=this._save=this._save||{status:"ready"};a&&a!==b.status&&(this.$el.removeClass("save-"+b.status),b.status=a);this.$el.addClass("save-"+b.status);return this},updateAll:function(){var a=this.$("[data-setting]"),b=this.model,a=_.chain(a).map(function(a){var d=c("input, textarea, select, [value]",a);if(d.length&&(a=c(a).data("setting"),d=d.val(),b.get(a)!==d))return[a,d]}).compact().object().value();_.isEmpty(a)||b.save(a)},removeFromLibrary:function(a){if("keydown"!==
a.type||13===a.keyCode||32===a.keyCode)a.stopPropagation(),this.collection.remove(this.model)},checkClickHandler:function(a){var b=this.options.selection;b&&(a.stopPropagation(),b.where({id:this.model.get("id")}).length?(b.remove(this.model),this.$el.focus()):b.add(this.model))}});_.each({caption:"_syncCaption",title:"_syncTitle",artist:"_syncArtist",album:"_syncAlbum"},function(a,c){b.prototype[a]=function(a,b){var d=this.$('[data-setting="'+c+'"]');return d.length&&b!==d.find("input, textarea, select, [value]").val()?
this.render():this}});f.exports=b},{}],26:[function(e,f,g){var d=wp.media.view.Attachment,c=wp.media.view.l10n;e=d.extend({tagName:"div",className:"attachment-details",template:wp.template("attachment-details"),attributes:function(){return{tabIndex:0,"data-id":this.model.get("id")}},events:{"change [data-setting]":"updateSetting","change [data-setting] input":"updateSetting","change [data-setting] select":"updateSetting","change [data-setting] textarea":"updateSetting","click .delete-attachment":"deleteAttachment",
"click .trash-attachment":"trashAttachment","click .untrash-attachment":"untrashAttachment","click .edit-attachment":"editAttachment",keydown:"toggleSelectionHandler"},initialize:function(){this.options=_.defaults(this.options,{rerenderOnModelChange:!1});this.on("ready",this.initialFocus);d.prototype.initialize.apply(this,arguments)},initialFocus:function(){wp.media.isTouchDevice||this.$('input[type="text"]').eq(0).focus()},deleteAttachment:function(b){b.preventDefault();window.confirm(c.warnDelete)&&
(this.model.destroy(),this.controller.modal.focusManager.focus())},trashAttachment:function(b){var a=this.controller.library;b.preventDefault();wp.media.view.settings.mediaTrash&&"edit-metadata"===this.controller.content.mode()?(this.model.set("status","trash"),this.model.save().done(function(){a._requery(!0)})):this.model.destroy()},untrashAttachment:function(b){var a=this.controller.library;b.preventDefault();this.model.set("status","inherit");this.model.save().done(function(){a._requery(!0)})},
editAttachment:function(b){var a=this.controller.states.get("edit-image");window.imageEdit&&a?(b.preventDefault(),a.set("image",this.model),this.controller.setState("edit-image")):this.$el.addClass("needs-refresh")},toggleSelectionHandler:function(b){if("keydown"===b.type&&9===b.keyCode&&b.shiftKey&&b.target===this.$(":tabbable").get(0))return this.controller.trigger("attachment:details:shift-tab",b),!1;37!==b.keyCode&&38!==b.keyCode&&39!==b.keyCode&&40!==b.keyCode||this.controller.trigger("attachment:keydown:arrow",
b)}});f.exports=e},{}],27:[function(e,f,g){e=wp.media.view.Attachment.extend({buttons:{close:!0}});f.exports=e},{}],28:[function(e,f,g){e=wp.media.view.Attachment.Selection.extend({buttons:{close:!0}});f.exports=e},{}],29:[function(e,f,g){e=wp.media.view.Attachment.extend({buttons:{check:!0}});f.exports=e},{}],30:[function(e,f,g){e=wp.media.view.Attachment.extend({className:"attachment selection",toggleSelection:function(){this.options.selection.single(this.model)}});f.exports=e},{}],31:[function(e,
f,g){var d=wp.media.View,c=jQuery;e=d.extend({tagName:"ul",className:"attachments",attributes:{tabIndex:-1},initialize:function(){this.el.id=_.uniqueId("__attachments-view-");_.defaults(this.options,{refreshSensitivity:wp.media.isTouchDevice?300:200,refreshThreshold:3,AttachmentView:wp.media.view.Attachment,sortable:!1,resize:!0,idealColumnWidth:640>c(window).width()?135:150});this._viewsByCid={};this.$window=c(window);this.resizeEvent="resize.media-modal-columns";this.collection.on("add",function(b){this.views.add(this.createAttachmentView(b),
{at:this.collection.indexOf(b)})},this);this.collection.on("remove",function(b){var a=this._viewsByCid[b.cid];delete this._viewsByCid[b.cid];a&&a.remove()},this);this.collection.on("reset",this.render,this);this.listenTo(this.controller,"library:selection:add",this.attachmentFocus);this.scroll=_.chain(this.scroll).bind(this).throttle(this.options.refreshSensitivity).value();this.options.scrollElement=this.options.scrollElement||this.el;c(this.options.scrollElement).on("scroll",this.scroll);this.initSortable();
_.bindAll(this,"setColumns");this.options.resize&&(this.on("ready",this.bindEvents),this.controller.on("open",this.setColumns),_.defer(this.setColumns,this))},bindEvents:function(){this.$window.off(this.resizeEvent).on(this.resizeEvent,_.debounce(this.setColumns,50))},attachmentFocus:function(){this.$("li:first").focus()},restoreFocus:function(){this.$("li.selected:first").focus()},arrowEvent:function(b){var a=this.$el.children("li"),c=this.columns,d=a.filter(":focus").index(),e=d+1<=c?1:Math.ceil((d+
1)/c);if(-1!==d){if(37===b.keyCode){if(0===d)return;a.eq(d-1).focus()}if(38===b.keyCode){if(1===e)return;a.eq(d-c).focus()}if(39===b.keyCode){if(a.length===d)return;a.eq(d+1).focus()}40===b.keyCode&&Math.ceil(a.length/c)!==e&&a.eq(d+c).focus()}},dispose:function(){this.collection.props.off(null,null,this);this.options.resize&&this.$window.off(this.resizeEvent);d.prototype.dispose.apply(this,arguments)},setColumns:function(){var b=this.columns,a=this.$el.width();a&&(this.columns=Math.min(Math.round(a/
this.options.idealColumnWidth),12)||1,b&&b===this.columns||this.$el.closest(".media-frame-content").attr("data-columns",this.columns))},initSortable:function(){var b=this.collection;!wp.media.isTouchDevice&&this.options.sortable&&c.fn.sortable&&(this.$el.sortable(_.extend({disabled:!!b.comparator,tolerance:"pointer",start:function(a,b){b.item.data("sortableIndexStart",b.item.index())},update:function(a,c){var d=b.at(c.item.data("sortableIndexStart")),e=b.comparator;delete b.comparator;b.remove(d,
{silent:!0});b.add(d,{silent:!0,at:c.item.index()});b.comparator=e;b.trigger("reset",b);b.saveMenuOrder()}},this.options.sortable)),b.props.on("change:orderby",function(){this.$el.sortable("option","disabled",!!b.comparator)},this),this.collection.props.on("change:orderby",this.refreshSortable,this),this.refreshSortable())},refreshSortable:function(){if(!wp.media.isTouchDevice&&this.options.sortable&&c.fn.sortable){var b=this.collection,b="menuOrder"===b.props.get("orderby")||!b.comparator;this.$el.sortable("option",
"disabled",!b)}},createAttachmentView:function(b){var a=new this.options.AttachmentView({controller:this.controller,model:b,collection:this.collection,selection:this.options.selection});return this._viewsByCid[b.cid]=a},prepare:function(){this.collection.length?this.views.set(this.collection.map(this.createAttachmentView,this)):(this.views.unset(),this.collection.more().done(this.scroll))},ready:function(){this.scroll()},scroll:function(){var b=this,a=this.options.scrollElement,d=a.scrollTop,e;a===
document&&(a=document.body,d=c(document).scrollTop());c(a).is(":visible")&&this.collection.hasMore()&&(e=this.views.parent.toolbar,a.scrollHeight-(d+a.clientHeight)<a.clientHeight/3&&e.get("spinner").show(),a.scrollHeight<d+a.clientHeight*this.options.refreshThreshold&&this.collection.more().done(function(){b.scroll();e.get("spinner").hide()}))}});f.exports=e},{}],32:[function(e,f,g){var d=wp.media.View,c=wp.media.view.settings.mediaTrash,b=wp.media.view.l10n,a=jQuery;e=d.extend({tagName:"div",className:"attachments-browser",
initialize:function(){_.defaults(this.options,{filters:!1,search:!0,date:!0,display:!1,sidebar:!0,AttachmentView:wp.media.view.Attachment.Library});this.listenTo(this.controller,"toggle:upload:attachment",_.bind(this.toggleUploader,this));this.controller.on("edit:selection",this.editSelection);this.createToolbar();this.options.sidebar&&this.createSidebar();this.createUploader();this.createAttachments();this.updateContent();this.options.sidebar&&"errors"!==this.options.sidebar||(this.$el.addClass("hide-sidebar"),
"errors"===this.options.sidebar&&this.$el.addClass("sidebar-for-errors"));this.collection.on("add remove reset",this.updateContent,this)},editSelection:function(a){a.$(".media-button-backToLibrary").focus()},dispose:function(){this.options.selection.off(null,null,this);d.prototype.dispose.apply(this,arguments);return this},createToolbar:function(){var e,f;e={controller:this.controller};this.controller.isModeActive("grid")&&(e.className="media-toolbar wp-filter");this.toolbar=new wp.media.view.Toolbar(e);
this.views.add(this.toolbar);this.toolbar.set("spinner",new wp.media.view.Spinner({priority:-60}));-1!==a.inArray(this.options.filters,["uploaded","all"])&&(this.toolbar.set("filtersLabel",(new wp.media.view.Label({value:b.filterByType,attributes:{"for":"media-attachment-filters"},priority:-80})).render()),"uploaded"===this.options.filters?this.toolbar.set("filters",(new wp.media.view.AttachmentFilters.Uploaded({controller:this.controller,model:this.collection.props,priority:-80})).render()):(f=new wp.media.view.AttachmentFilters.All({controller:this.controller,
model:this.collection.props,priority:-80}),this.toolbar.set("filters",f.render())));this.controller.isModeActive("grid")?(e=d.extend({className:"view-switch media-grid-view-switch",template:wp.template("media-library-view-switcher")}),this.toolbar.set("libraryViewSwitcher",(new e({controller:this.controller,priority:-90})).render()),this.toolbar.set("dateFilterLabel",(new wp.media.view.Label({value:b.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75})).render()),this.toolbar.set("dateFilter",
(new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75})).render()),this.toolbar.set("selectModeToggleButton",(new wp.media.view.SelectModeToggleButton({text:b.bulkSelect,controller:this.controller,priority:-70})).render()),this.toolbar.set("deleteSelectedButton",(new wp.media.view.DeleteSelectedButton({filters:f,style:"primary",disabled:!0,text:c?b.trashSelected:b.deleteSelected,controller:this.controller,priority:-60,click:function(){var d=[],e=[],f=this.controller.state().get("selection"),
l=this.controller.state().get("library");!f.length||!c&&!window.confirm(b.warnBulkDelete)||c&&"trash"!==f.at(0).get("status")&&!window.confirm(b.warnBulkTrash)||(f.each(function(a){a.get("nonces")["delete"]?c&&"trash"===a.get("status")?(a.set("status","inherit"),d.push(a.save()),e.push(a)):c?(a.set("status","trash"),d.push(a.save()),e.push(a)):a.destroy({wait:!0}):e.push(a)}),d.length?(f.remove(e),a.when.apply(null,d).then(_.bind(function(){l._requery(!0);this.controller.trigger("selection:action:done")},
this))):this.controller.trigger("selection:action:done"))}})).render()),c&&this.toolbar.set("deleteSelectedPermanentlyButton",(new wp.media.view.DeleteSelectedPermanentlyButton({filters:f,style:"primary",disabled:!0,text:b.deleteSelected,controller:this.controller,priority:-55,click:function(){var a=[],c=this.controller.state().get("selection");c.length&&window.confirm(b.warnBulkDelete)&&(c.each(function(b){b.get("nonces")["delete"]?b.destroy():a.push(b)}),c.remove(a),this.controller.trigger("selection:action:done"))}})).render())):
this.options.date&&(this.toolbar.set("dateFilterLabel",(new wp.media.view.Label({value:b.filterByDate,attributes:{"for":"media-attachment-date-filters"},priority:-75})).render()),this.toolbar.set("dateFilter",(new wp.media.view.DateFilter({controller:this.controller,model:this.collection.props,priority:-75})).render()));this.options.search&&(this.toolbar.set("searchLabel",(new wp.media.view.Label({value:b.searchMediaLabel,attributes:{"for":"media-search-input"},priority:60})).render()),this.toolbar.set("search",
(new wp.media.view.Search({controller:this.controller,model:this.collection.props,priority:60})).render()));this.options.dragInfo&&this.toolbar.set("dragInfo",new d({el:a('<div class="instructions">'+b.dragInfo+"</div>")[0],priority:-40}));this.options.suggestedWidth&&this.options.suggestedHeight&&this.toolbar.set("suggestedDimensions",new d({el:a('<div class="instructions">'+b.suggestedDimensions+" "+this.options.suggestedWidth+" &times; "+this.options.suggestedHeight+"</div>")[0],priority:-40}))},
updateContent:function(){var a=this,b;b=this.controller.isModeActive("grid")?a.attachmentsNoResults:a.uploader;this.collection.length?(b.$el.addClass("hidden"),a.toolbar.get("spinner").hide()):(this.toolbar.get("spinner").show(),this.dfd=this.collection.more().done(function(){a.collection.length?b.$el.addClass("hidden"):b.$el.removeClass("hidden");a.toolbar.get("spinner").hide()}))},createUploader:function(){this.uploader=new wp.media.view.UploaderInline({controller:this.controller,status:!1,message:this.controller.isModeActive("grid")?
"":b.noItemsFound,canClose:this.controller.isModeActive("grid")});this.uploader.hide();this.views.add(this.uploader)},toggleUploader:function(){this.uploader.$el.hasClass("hidden")?this.uploader.show():this.uploader.hide()},createAttachments:function(){this.attachments=new wp.media.view.Attachments({controller:this.controller,collection:this.collection,selection:this.options.selection,model:this.model,sortable:this.options.sortable,scrollElement:this.options.scrollElement,idealColumnWidth:this.options.idealColumnWidth,
AttachmentView:this.options.AttachmentView});this.attachments.listenTo(this.controller,"attachment:keydown:arrow",this.attachments.arrowEvent);this.attachments.listenTo(this.controller,"attachment:details:shift-tab",this.attachments.restoreFocus);this.views.add(this.attachments);this.controller.isModeActive("grid")&&(this.attachmentsNoResults=new d({controller:this.controller,tagName:"p"}),this.attachmentsNoResults.$el.addClass("hidden no-media"),this.attachmentsNoResults.$el.html(b.noMedia),this.views.add(this.attachmentsNoResults))},
createSidebar:function(){var a=this.options.selection,b=this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.views.add(b);this.controller.uploader&&b.set("uploads",new wp.media.view.UploaderStatus({controller:this.controller,priority:40}));a.on("selection:single",this.createSingle,this);a.on("selection:unsingle",this.disposeSingle,this);a.single()&&this.createSingle()},createSingle:function(){var a=this.sidebar,b=this.options.selection.single();a.set("details",new wp.media.view.Attachment.Details({controller:this.controller,
model:b,priority:80}));a.set("compat",new wp.media.view.AttachmentCompat({controller:this.controller,model:b,priority:120}));this.options.display&&a.set("display",new wp.media.view.Settings.AttachmentDisplay({controller:this.controller,model:this.model.display(b),attachment:b,priority:160,userSettings:this.model.get("displayUserSettings")}));"insert"===this.model.id&&a.$el.addClass("visible")},disposeSingle:function(){var a=this.sidebar;a.unset("details");a.unset("compat");a.unset("display");a.$el.removeClass("visible")}});
f.exports=e},{}],33:[function(e,f,g){var d=wp.media.view.Attachments;e=d.extend({events:{},initialize:function(){_.defaults(this.options,{sortable:!1,resize:!1,AttachmentView:wp.media.view.Attachment.Selection});return d.prototype.initialize.apply(this,arguments)}});f.exports=e},{}],34:[function(e,f,g){var d=Backbone.$;e=wp.media.View.extend({tagName:"div",className:"button-group button-large media-button-group",initialize:function(){this.buttons=_.map(this.options.buttons||[],function(c){return c instanceof
Backbone.View?c:(new wp.media.view.Button(c)).render()});delete this.options.buttons;this.options.classes&&this.$el.addClass(this.options.classes)},render:function(){this.$el.html(d(_.pluck(this.buttons,"el")).detach());return this}});f.exports=e},{}],35:[function(e,f,g){e=wp.media.View.extend({tagName:"button",className:"media-button",attributes:{type:"button"},events:{click:"click"},defaults:{text:"",style:"",size:"large",disabled:!1},initialize:function(){this.model=new Backbone.Model(this.defaults);
_.each(this.defaults,function(d,c){var b=this.options[c];_.isUndefined(b)||(this.model.set(c,b),delete this.options[c])},this);this.listenTo(this.model,"change",this.render)},render:function(){var d=["button",this.className],c=this.model.toJSON();c.style&&d.push("button-"+c.style);c.size&&d.push("button-"+c.size);d=_.uniq(d.concat(this.options.classes));this.el.className=d.join(" ");this.$el.attr("disabled",c.disabled);this.$el.text(this.model.get("text"));return this},click:function(d){"#"===this.attributes.href&&
d.preventDefault();this.options.click&&!this.model.get("disabled")&&this.options.click.apply(this,arguments)}});f.exports=e},{}],36:[function(e,f,g){var d=wp.media.View,c=wp.media.view.UploaderStatus,b=wp.media.view.l10n,a=jQuery;e=d.extend({className:"crop-content",template:wp.template("crop-content"),initialize:function(){_.bindAll(this,"onImageLoad")},ready:function(){this.controller.frame.on("content:error:crop",this.onError,this);this.$image=this.$el.find(".crop-image");this.$image.on("load",
this.onImageLoad);a(window).on("resize.cropper",_.debounce(this.onImageLoad,250))},remove:function(){a(window).off("resize.cropper");this.$el.remove();this.$el.off();d.prototype.remove.apply(this,arguments)},prepare:function(){return{title:b.cropYourImage,url:this.options.attachment.get("url")}},onImageLoad:function(){var a=this.controller.get("imgSelectOptions");"function"===typeof a&&(a=a(this.options.attachment,this.controller));a=_.extend(a,{parent:this.$el});this.trigger("image-loaded");this.controller.imgSelect=
this.$image.imgAreaSelect(a)},onError:function(){var a=this.options.attachment.get("filename");this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:c.prototype.filename(a),message:window._wpMediaViewsL10n.cropError}),{at:0})}});f.exports=e},{}],37:[function(e,f,g){var d=wp.media.View;e=d.extend({className:"image-editor",template:wp.template("image-editor"),initialize:function(c){this.editor=window.imageEdit;this.controller=c.controller;d.prototype.initialize.apply(this,
arguments)},prepare:function(){return this.model.toJSON()},loadEditor:function(){this.editor.open(this.model.get("id"),this.model.get("nonces").edit,this).done(_.bind(this.focus,this))},focus:function(){this.$(".imgedit-submit .button").eq(0).focus()},back:function(){var c=this.controller.lastState();this.controller.setState(c)},refresh:function(){this.model.fetch()},save:function(){var c=this.controller.lastState();this.model.fetch().done(_.bind(function(){this.controller.setState(c)},this))}});
f.exports=e},{}],38:[function(e,f,g){e=wp.media.View.extend({className:"media-embed",initialize:function(){this.url=(new wp.media.view.EmbedUrl({controller:this.controller,model:this.model.props})).render();this.views.set([this.url]);this.refresh();this.listenTo(this.model,"change:type",this.refresh);this.listenTo(this.model,"change:loading",this.loading)},settings:function(d){this._settings&&this._settings.remove();this._settings=d;this.views.add(d)},refresh:function(){var d=this.model.get("type");
if("image"===d)d=wp.media.view.EmbedImage;else if("link"===d)d=wp.media.view.EmbedLink;else return;this.settings(new d({controller:this.controller,model:this.model.props,priority:40}))},loading:function(){this.$el.toggleClass("embed-loading",this.model.get("loading"))}});f.exports=e},{}],39:[function(e,f,g){var d=wp.media.view.Settings.AttachmentDisplay;e=d.extend({className:"embed-media-settings",template:wp.template("embed-image-settings"),initialize:function(){d.prototype.initialize.apply(this,
arguments);this.listenTo(this.model,"change:url",this.updateImage)},updateImage:function(){this.$("img").attr("src",this.model.get("url"))}});f.exports=e},{}],40:[function(e,f,g){var d=jQuery;e=wp.media.view.Settings.extend({className:"embed-link-settings",template:wp.template("embed-link-settings"),initialize:function(){this.listenTo(this.model,"change:url",this.updateoEmbed)},updateoEmbed:_.debounce(function(){var c=this.model.get("url");this.$(".embed-container").hide().find(".embed-preview").empty();
this.$(".setting").hide();c&&(11>c.length||!c.match(/^http(s)?:\/\//))||this.fetch()},wp.media.controller.Embed.sensitivity),fetch:function(){var c;d("#embed-url-field").val()===this.model.get("url")&&(this.dfd&&"pending"===this.dfd.state()&&this.dfd.abort(),c=new wp.shortcode({tag:"embed",attrs:_.pick(this.model.attributes,["width","height","src"]),content:this.model.get("url")}),this.dfd=d.ajax({type:"POST",url:wp.ajax.settings.url,context:this,data:{action:"parse-embed",post_ID:wp.media.view.settings.post.id,
shortcode:c.string()}}).done(this.renderoEmbed).fail(this.renderFail))},renderFail:function(c,b){"abort"!==b&&this.$(".link-text").show()},renderoEmbed:function(c){(c=c&&c.data&&c.data.body||"")?this.$(".embed-container").show().find(".embed-preview").html(c):this.renderFail()}});f.exports=e},{}],41:[function(e,f,g){var d=wp.media.View,c=jQuery;e=d.extend({tagName:"label",className:"embed-url",events:{input:"url",keyup:"url",change:"url"},initialize:function(){this.$input=c('<input id="embed-url-field" type="url" />').val(this.model.get("url"));
this.input=this.$input[0];this.spinner=c('<span class="spinner" />')[0];this.$el.append([this.input,this.spinner]);this.listenTo(this.model,"change:url",this.render);this.model.get("url")&&_.delay(_.bind(function(){this.model.trigger("change:url")},this),500)},render:function(){if(!this.$input.is(":focus"))return this.input.value=this.model.get("url")||"http://",d.prototype.render.apply(this,arguments),this},ready:function(){wp.media.isTouchDevice||this.focus()},url:function(b){this.model.set("url",
b.target.value)},focus:function(){var b=this.$input;b.is(":visible")&&b.focus()[0].select()}});f.exports=e},{}],42:[function(e,f,g){e=wp.media.View.extend({events:{keydown:"constrainTabbing"},focus:function(){this.$(".media-menu-item").first().focus()},constrainTabbing:function(d){var c;if(9===d.keyCode){c=this.$(":tabbable").not('.moxie-shim input[type="file"]');if(c.last()[0]===d.target&&!d.shiftKey)return c.first().focus(),!1;if(c.first()[0]===d.target&&d.shiftKey)return c.last().focus(),!1}}});
f.exports=e},{}],43:[function(e,f,g){e=wp.media.View.extend({initialize:function(){_.defaults(this.options,{mode:["select"]});this._createRegions();this._createStates();this._createModes()},_createRegions:function(){this.regions=this.regions?this.regions.slice():[];_.each(this.regions,function(d){this[d]=new wp.media.controller.Region({view:this,id:d,selector:".media-frame-"+d})},this)},_createStates:function(){this.states=new Backbone.Collection(null,{model:wp.media.controller.State});this.states.on("add",
function(d){d.frame=this;d.trigger("ready")},this);this.options.states&&this.states.add(this.options.states)},_createModes:function(){this.activeModes=new Backbone.Collection;this.activeModes.on("add remove reset",_.bind(this.triggerModeEvents,this));_.each(this.options.mode,function(d){this.activateMode(d)},this)},reset:function(){this.states.invoke("trigger","reset");return this},triggerModeEvents:function(d,c,b){var a;c={add:"activate",remove:"deactivate"};_.each(b,function(b,c){b&&(a=c)});_.has(c,
a)&&(d=d.get("id")+":"+c[a],this.trigger(d))},activateMode:function(d){if(!this.isModeActive(d))return this.activeModes.add([{id:d}]),this.$el.addClass("mode-"+d),this},deactivateMode:function(d){if(!this.isModeActive(d))return this;this.activeModes.remove(this.activeModes.where({id:d}));this.$el.removeClass("mode-"+d);this.trigger(d+":deactivate");return this},isModeActive:function(d){return Boolean(this.activeModes.where({id:d}).length)}});_.extend(e.prototype,wp.media.controller.StateMachine.prototype);
f.exports=e},{}],44:[function(e,f,g){var d=wp.media.view.MediaFrame.Select,c=wp.media.view.l10n;e=d.extend({defaults:{id:"image",url:"",menu:"image-details",content:"image-details",toolbar:"image-details",type:"link",title:c.imageDetailsTitle,priority:120},initialize:function(b){this.image=new wp.media.model.PostImage(b.metadata);this.options.selection=new wp.media.model.Selection(this.image.attachment,{multiple:!1});d.prototype.initialize.apply(this,arguments)},bindHandlers:function(){d.prototype.bindHandlers.apply(this,
arguments);this.on("menu:create:image-details",this.createMenu,this);this.on("content:create:image-details",this.imageDetailsContent,this);this.on("content:render:edit-image",this.editImageContent,this);this.on("toolbar:render:image-details",this.renderImageDetailsToolbar,this);this.on("toolbar:render:replace",this.renderReplaceImageToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.ImageDetails({image:this.image,editable:!1}),new wp.media.controller.ReplaceImage({id:"replace-image",
library:wp.media.query({type:"image"}),image:this.image,multiple:!1,title:c.imageReplaceTitle,toolbar:"replace",priority:80,displaySettings:!0}),new wp.media.controller.EditImage({image:this.image,selection:this.options.selection})])},imageDetailsContent:function(b){b.view=new wp.media.view.ImageDetails({controller:this,model:this.state().image,attachment:this.state().image.attachment})},editImageContent:function(){var b=this.state().get("image");b&&(b=(new wp.media.view.EditImage({model:b,controller:this})).render(),
this.content.set(b),b.loadEditor())},renderImageDetailsToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{select:{style:"primary",text:c.update,priority:80,click:function(){var b=this.controller,a=b.state();b.close();a.trigger("update",b.image.toJSON());b.setState(b.options.state);b.reset()}}}}))},renderReplaceImageToolbar:function(){var b=this,a=b.lastState(),d=a&&a.id;this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{back:{text:c.back,priority:20,
click:function(){d?b.setState(d):b.close()}},replace:{style:"primary",text:c.replace,priority:80,click:function(){var a=this.controller,b=a.state(),c=b.get("selection").single();a.close();a.image.changeAttachment(c,b.display(c));b.trigger("replace",a.image.toJSON());a.setState(a.options.state);a.reset()}}}}))}});f.exports=e},{}],45:[function(e,f,g){var d=wp.media.view.MediaFrame.Select,c=wp.media.controller.Library,b=wp.media.view.l10n;e=d.extend({initialize:function(){this.counts={audio:{count:wp.media.view.settings.attachmentCounts.audio,
state:"playlist"},video:{count:wp.media.view.settings.attachmentCounts.video,state:"video-playlist"}};_.defaults(this.options,{multiple:!0,editing:!1,state:"insert",metadata:{}});d.prototype.initialize.apply(this,arguments);this.createIframeStates()},createStates:function(){var a=this.options;this.states.add([new c({id:"insert",title:b.insertMediaTitle,priority:20,toolbar:"main-insert",filterable:"all",library:wp.media.query(a.library),multiple:a.multiple?"reset":!1,editable:!0,allowLocalEdits:!0,
displaySettings:!0,displayUserSettings:!0}),new c({id:"gallery",title:b.createGalleryTitle,priority:40,toolbar:"main-gallery",filterable:"uploaded",multiple:"add",editable:!1,library:wp.media.query(_.defaults({type:"image"},a.library))}),new wp.media.controller.Embed({metadata:a.metadata}),new wp.media.controller.EditImage({model:a.editImage}),new wp.media.controller.GalleryEdit({library:a.selection,editing:a.editing,menu:"gallery"}),new wp.media.controller.GalleryAdd,new c({id:"playlist",title:b.createPlaylistTitle,
priority:60,toolbar:"main-playlist",filterable:"uploaded",multiple:"add",editable:!1,library:wp.media.query(_.defaults({type:"audio"},a.library))}),new wp.media.controller.CollectionEdit({type:"audio",collectionType:"playlist",title:b.editPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:a.selection,editing:a.editing,menu:"playlist",dragInfoText:b.playlistDragInfo,dragInfo:!1}),new wp.media.controller.CollectionAdd({type:"audio",collectionType:"playlist",title:b.addToPlaylistTitle}),
new c({id:"video-playlist",title:b.createVideoPlaylistTitle,priority:60,toolbar:"main-video-playlist",filterable:"uploaded",multiple:"add",editable:!1,library:wp.media.query(_.defaults({type:"video"},a.library))}),new wp.media.controller.CollectionEdit({type:"video",collectionType:"playlist",title:b.editVideoPlaylistTitle,SettingsView:wp.media.view.Settings.Playlist,library:a.selection,editing:a.editing,menu:"video-playlist",dragInfoText:b.videoPlaylistDragInfo,dragInfo:!1}),new wp.media.controller.CollectionAdd({type:"video",
collectionType:"playlist",title:b.addToVideoPlaylistTitle})]);wp.media.view.settings.post.featuredImageId&&this.states.add(new wp.media.controller.FeaturedImage)},bindHandlers:function(){d.prototype.bindHandlers.apply(this,arguments);this.on("activate",this.activate,this);"undefined"!==typeof _.find(this.counts,function(a){return 0===a.count})&&this.listenTo(wp.media.model.Attachments.all,"change:type",this.mediaTypeCounts);this.on("menu:create:gallery",this.createMenu,this);this.on("menu:create:playlist",
this.createMenu,this);this.on("menu:create:video-playlist",this.createMenu,this);this.on("toolbar:create:main-insert",this.createToolbar,this);this.on("toolbar:create:main-gallery",this.createToolbar,this);this.on("toolbar:create:main-playlist",this.createToolbar,this);this.on("toolbar:create:main-video-playlist",this.createToolbar,this);this.on("toolbar:create:featured-image",this.featuredImageToolbar,this);this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this);_.each({menu:{"default":"mainMenu",
gallery:"galleryMenu",playlist:"playlistMenu","video-playlist":"videoPlaylistMenu"},content:{embed:"embedContent","edit-image":"editImageContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar","main-gallery":"mainGalleryToolbar","gallery-edit":"galleryEditToolbar","gallery-add":"galleryAddToolbar","main-playlist":"mainPlaylistToolbar","playlist-edit":"playlistEditToolbar","playlist-add":"playlistAddToolbar","main-video-playlist":"mainVideoPlaylistToolbar","video-playlist-edit":"videoPlaylistEditToolbar",
"video-playlist-add":"videoPlaylistAddToolbar"}},function(a,b){_.each(a,function(a,c){this.on(b+":render:"+c,this[a],this)},this)},this)},activate:function(){_.each(this.counts,function(a){1>a.count&&this.menuItemVisibility(a.state,"hide")},this)},mediaTypeCounts:function(a,b){"undefined"!==typeof this.counts[b]&&1>this.counts[b].count&&(this.counts[b].count++,this.menuItemVisibility(this.counts[b].state,"show"))},mainMenu:function(a){a.set({"library-separator":new wp.media.View({className:"separator",
priority:100})})},menuItemVisibility:function(a,b){var c=this.menu.get();"hide"===b?c.hide(a):"show"===b&&c.show(a)},galleryMenu:function(a){var c=this.lastState(),d=c&&c.id,e=this;a.set({cancel:{text:b.cancelGalleryTitle,priority:20,click:function(){d?e.setState(d):e.close();this.controller.modal.focusManager.focus()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},playlistMenu:function(a){var c=this.lastState(),d=c&&c.id,e=this;a.set({cancel:{text:b.cancelPlaylistTitle,
priority:20,click:function(){d?e.setState(d):e.close()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},videoPlaylistMenu:function(a){var c=this.lastState(),d=c&&c.id,e=this;a.set({cancel:{text:b.cancelVideoPlaylistTitle,priority:20,click:function(){d?e.setState(d):e.close()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},embedContent:function(){var a=(new wp.media.view.Embed({controller:this,model:this.state()})).render();this.content.set(a);wp.media.isTouchDevice||
a.url.focus()},editSelectionContent:function(){var a=this.state(),c=a.get("selection"),a=(new wp.media.view.AttachmentsBrowser({controller:this,collection:c,selection:c,model:a,sortable:!0,search:!1,date:!1,dragInfo:!0,AttachmentView:wp.media.view.Attachments.EditSelection})).render();a.toolbar.set("backToLibrary",{text:b.returnToLibrary,priority:-100,click:function(){this.controller.content.mode("browse")}});this.content.set(a);this.trigger("edit:selection",this)},editImageContent:function(){var a=
this.state().get("image"),a=(new wp.media.view.EditImage({model:a,controller:this})).render();this.content.set(a);a.loadEditor()},selectionStatusToolbar:function(a){var b=this.state().get("editable");a.set("selection",(new wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:b&&function(){this.controller.content.mode("edit-selection")}})).render())},mainInsertToolbar:function(a){var c=this;this.selectionStatusToolbar(a);a.set("insert",{style:"primary",
priority:80,text:b.insertIntoPost,requires:{selection:!0},click:function(){var a=c.state(),b=a.get("selection");c.close();a.trigger("insert",b).reset()}})},mainGalleryToolbar:function(a){var c=this;this.selectionStatusToolbar(a);a.set("gallery",{style:"primary",text:b.createNewGallery,priority:60,requires:{selection:!0},click:function(){var a=c.state().get("selection"),b=c.state("gallery-edit"),d=a.where({type:"image"});b.set("library",new wp.media.model.Selection(d,{props:a.props.toJSON(),multiple:!0}));
this.controller.setState("gallery-edit");this.controller.modal.focusManager.focus()}})},mainPlaylistToolbar:function(a){var c=this;this.selectionStatusToolbar(a);a.set("playlist",{style:"primary",text:b.createNewPlaylist,priority:100,requires:{selection:!0},click:function(){var a=c.state().get("selection"),b=c.state("playlist-edit"),d=a.where({type:"audio"});b.set("library",new wp.media.model.Selection(d,{props:a.props.toJSON(),multiple:!0}));this.controller.setState("playlist-edit");this.controller.modal.focusManager.focus()}})},
mainVideoPlaylistToolbar:function(a){var c=this;this.selectionStatusToolbar(a);a.set("video-playlist",{style:"primary",text:b.createNewVideoPlaylist,priority:100,requires:{selection:!0},click:function(){var a=c.state().get("selection"),b=c.state("video-playlist-edit"),d=a.where({type:"video"});b.set("library",new wp.media.model.Selection(d,{props:a.props.toJSON(),multiple:!0}));this.controller.setState("video-playlist-edit");this.controller.modal.focusManager.focus()}})},featuredImageToolbar:function(a){this.createSelectToolbar(a,
{text:b.setFeaturedImage,state:this.options.state})},mainEmbedToolbar:function(a){a.view=new wp.media.view.Toolbar.Embed({controller:this})},galleryEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:a?b.updateGallery:b.insertGallery,priority:80,requires:{library:!0},click:function(){var a=this.controller,b=a.state();a.close();b.trigger("update",b.get("library"));a.setState(a.options.state);a.reset()}}}}))},
galleryAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:b.addToGallery,priority:80,requires:{selection:!0},click:function(){var a=this.controller,b=a.state();a.state("gallery-edit").get("library").add(b.get("selection").models);b.trigger("reset");a.setState("gallery-edit")}}}}))},playlistEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",
text:a?b.updatePlaylist:b.insertPlaylist,priority:80,requires:{library:!0},click:function(){var a=this.controller,b=a.state();a.close();b.trigger("update",b.get("library"));a.setState(a.options.state);a.reset()}}}}))},playlistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:b.addToPlaylist,priority:80,requires:{selection:!0},click:function(){var a=this.controller,b=a.state();a.state("playlist-edit").get("library").add(b.get("selection").models);
b.trigger("reset");a.setState("playlist-edit")}}}}))},videoPlaylistEditToolbar:function(){var a=this.state().get("editing");this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{insert:{style:"primary",text:a?b.updateVideoPlaylist:b.insertVideoPlaylist,priority:140,requires:{library:!0},click:function(){var a=this.controller,b=a.state(),c=b.get("library");c.type="video";a.close();b.trigger("update",c);a.setState(a.options.state);a.reset()}}}}))},videoPlaylistAddToolbar:function(){this.toolbar.set(new wp.media.view.Toolbar({controller:this,
items:{insert:{style:"primary",text:b.addToVideoPlaylist,priority:140,requires:{selection:!0},click:function(){var a=this.controller,b=a.state();a.state("video-playlist-edit").get("library").add(b.get("selection").models);b.trigger("reset");a.setState("video-playlist-edit")}}}}))}});f.exports=e},{}],46:[function(e,f,g){var d=wp.media.view.MediaFrame,c=wp.media.view.l10n;e=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments);_.defaults(this.options,{selection:[],library:{},
multiple:!1,state:"library"});this.createSelection();this.createStates();this.bindHandlers()},createSelection:function(){var b=this.options.selection;b instanceof wp.media.model.Selection||(this.options.selection=new wp.media.model.Selection(b,{multiple:this.options.multiple}));this._selection={attachments:new wp.media.model.Attachments,difference:[]}},createStates:function(){var b=this.options;this.options.states||this.states.add([new wp.media.controller.Library({library:wp.media.query(b.library),
multiple:b.multiple,title:b.title,priority:20})])},bindHandlers:function(){this.on("router:create:browse",this.createRouter,this);this.on("router:render:browse",this.browseRouter,this);this.on("content:create:browse",this.browseContent,this);this.on("content:render:upload",this.uploadContent,this);this.on("toolbar:create:select",this.createSelectToolbar,this)},browseRouter:function(b){b.set({upload:{text:c.uploadFilesTitle,priority:20},browse:{text:c.mediaLibraryTitle,priority:40}})},browseContent:function(b){var a=
this.state();this.$el.removeClass("hide-toolbar");b.view=new wp.media.view.AttachmentsBrowser({controller:this,collection:a.get("library"),selection:a.get("selection"),model:a,sortable:a.get("sortable"),search:a.get("searchable"),filters:a.get("filterable"),date:a.get("date"),display:a.has("display")?a.get("display"):a.get("displaySettings"),dragInfo:a.get("dragInfo"),idealColumnWidth:a.get("idealColumnWidth"),suggestedWidth:a.get("suggestedWidth"),suggestedHeight:a.get("suggestedHeight"),AttachmentView:a.get("AttachmentView")})},
uploadContent:function(){this.$el.removeClass("hide-toolbar");this.content.set(new wp.media.view.UploaderInline({controller:this}))},createSelectToolbar:function(b,a){a=a||this.options.button||{};a.controller=this;b.view=new wp.media.view.Toolbar.Select(a)}});f.exports=e},{}],47:[function(e,f,g){e=wp.media.View.extend({className:"media-iframe",render:function(){this.views.detach();this.$el.html('<iframe src="'+this.controller.state().get("src")+'" />');this.views.render();return this}});f.exports=
e},{}],48:[function(e,f,g){var d=wp.media.view.Settings.AttachmentDisplay,c=jQuery;e=d.extend({className:"image-details",template:wp.template("image-details"),events:_.defaults(d.prototype.events,{"click .edit-attachment":"editAttachment","click .replace-attachment":"replaceAttachment","click .advanced-toggle":"onToggleAdvanced",'change [data-setting="customWidth"]':"onCustomSize",'change [data-setting="customHeight"]':"onCustomSize",'keyup [data-setting="customWidth"]':"onCustomSize",'keyup [data-setting="customHeight"]':"onCustomSize"}),
initialize:function(){this.options.attachment=this.model.attachment;this.listenTo(this.model,"change:url",this.updateUrl);this.listenTo(this.model,"change:link",this.toggleLinkSettings);this.listenTo(this.model,"change:size",this.toggleCustomSize);d.prototype.initialize.apply(this,arguments)},prepare:function(){var b=!1;this.model.attachment&&(b=this.model.attachment.toJSON());return _.defaults({model:this.model.toJSON(),attachment:b},this.options)},render:function(){var b=arguments;this.model.attachment&&
"pending"===this.model.dfd.state()?this.model.dfd.done(_.bind(function(){d.prototype.render.apply(this,b);this.postRender()},this)).fail(_.bind(function(){this.model.attachment=!1;d.prototype.render.apply(this,b);this.postRender()},this)):(d.prototype.render.apply(this,arguments),this.postRender());return this},postRender:function(){setTimeout(_.bind(this.resetFocus,this),10);this.toggleLinkSettings();"show"===window.getUserSetting("advImgDetails")&&this.toggleAdvanced(!0);this.trigger("post-render")},
resetFocus:function(){this.$(".link-to-custom").blur();this.$(".embed-media-settings").scrollTop(0)},updateUrl:function(){this.$(".image img").attr("src",this.model.get("url"));this.$(".url").val(this.model.get("url"))},toggleLinkSettings:function(){"none"===this.model.get("link")?this.$(".link-settings").addClass("hidden"):this.$(".link-settings").removeClass("hidden")},toggleCustomSize:function(){"custom"!==this.model.get("size")?this.$(".custom-size").addClass("hidden"):this.$(".custom-size").removeClass("hidden")},
onCustomSize:function(b){var a=c(b.target).data("setting"),d=c(b.target).val();!/^\d+/.test(d)||1>parseInt(d,10)?b.preventDefault():"customWidth"===a?(b=Math.round(1/this.model.get("aspectRatio")*d),this.model.set("customHeight",b,{silent:!0}),this.$('[data-setting="customHeight"]').val(b)):(b=Math.round(this.model.get("aspectRatio")*d),this.model.set("customWidth",b,{silent:!0}),this.$('[data-setting="customWidth"]').val(b))},onToggleAdvanced:function(b){b.preventDefault();this.toggleAdvanced()},
toggleAdvanced:function(b){var a=this.$el.find(".advanced-section");a.hasClass("advanced-visible")||!1===b?(a.removeClass("advanced-visible"),a.find(".advanced-settings").addClass("hidden"),b="hide"):(a.addClass("advanced-visible"),a.find(".advanced-settings").removeClass("hidden"),b="show");window.setUserSetting("advImgDetails",b)},editAttachment:function(b){var a=this.controller.states.get("edit-image");window.imageEdit&&a&&(b.preventDefault(),a.set("image",this.model.attachment),this.controller.setState("edit-image"))},
replaceAttachment:function(b){b.preventDefault();this.controller.setState("replace-image")}});f.exports=e},{}],49:[function(e,f,g){e=wp.media.View.extend({tagName:"label",className:"screen-reader-text",initialize:function(){this.value=this.options.value},render:function(){this.$el.html(this.value);return this}});f.exports=e},{}],50:[function(e,f,g){var d=wp.media.view.Frame,c=jQuery,b;b=d.extend({className:"media-frame",template:wp.template("media-frame"),regions:["menu","title","content","toolbar",
"router"],events:{"click div.media-frame-title h1":"toggleMenu"},initialize:function(){d.prototype.initialize.apply(this,arguments);_.defaults(this.options,{title:"",modal:!0,uploader:!0});this.$el.addClass("wp-core-ui");this.options.modal&&(this.modal=new wp.media.view.Modal({controller:this,title:this.options.title}),this.modal.content(this));if(wp.Uploader.limitExceeded||!wp.Uploader.browser.supported)this.options.uploader=!1;this.options.uploader&&(this.uploader=new wp.media.view.UploaderWindow({controller:this,
uploader:{dropzone:this.modal?this.modal.$el:this.$el,container:this.$el}}),this.views.set(".media-frame-uploader",this.uploader));this.on("attach",_.bind(this.views.ready,this.views),this);this.on("title:create:default",this.createTitle,this);this.title.mode("default");this.on("title:render",function(a){a.$el.append('<span class="dashicons dashicons-arrow-down"></span>')});this.on("menu:create:default",this.createMenu,this)},render:function(){!this.state()&&this.options.state&&this.setState(this.options.state);
return d.prototype.render.apply(this,arguments)},createTitle:function(a){a.view=new wp.media.View({controller:this,tagName:"h1"})},createMenu:function(a){a.view=new wp.media.view.Menu({controller:this})},toggleMenu:function(){this.$el.find(".media-menu").toggleClass("visible")},createToolbar:function(a){a.view=new wp.media.view.Toolbar({controller:this})},createRouter:function(a){a.view=new wp.media.view.Router({controller:this})},createIframeStates:function(a){var b=wp.media.view.settings,d=b.tabs,
e=b.tabUrl;d&&e&&(b=c("#post_ID"),b.length&&(e+="&post_id="+b.val()),_.each(d,function(b,c){this.state("iframe:"+c).set(_.defaults({tab:c,src:e+"&tab="+c,title:b,content:"iframe",menu:"default"},a))},this),this.on("content:create:iframe",this.iframeContent,this),this.on("content:deactivate:iframe",this.iframeContentCleanup,this),this.on("menu:render:default",this.iframeMenu,this),this.on("open",this.hijackThickbox,this),this.on("close",this.restoreThickbox,this))},iframeContent:function(a){this.$el.addClass("hide-toolbar");
a.view=new wp.media.view.Iframe({controller:this})},iframeContentCleanup:function(){this.$el.removeClass("hide-toolbar")},iframeMenu:function(a){var b={};a&&(_.each(wp.media.view.settings.tabs,function(a,c){b["iframe:"+c]={text:this.state("iframe:"+c).get("title"),priority:200}},this),a.set(b))},hijackThickbox:function(){var a=this;window.tb_remove&&!this._tb_remove&&(this._tb_remove=window.tb_remove,window.tb_remove=function(){a.close();a.reset();a.setState(a.options.state);a._tb_remove.call(window)})},
restoreThickbox:function(){this._tb_remove&&(window.tb_remove=this._tb_remove,delete this._tb_remove)}});_.each(["open","close","attach","detach","escape"],function(a){b.prototype[a]=function(){this.modal&&this.modal[a].apply(this.modal,arguments);return this}});f.exports=b},{}],51:[function(e,f,g){var d=jQuery;e=wp.media.View.extend({tagName:"a",className:"media-menu-item",attributes:{href:"#"},events:{click:"_click"},_click:function(c){var b=this.options.click;c&&c.preventDefault();b?b.call(this):
this.click();wp.media.isTouchDevice||d(".media-frame-content input").first().focus()},click:function(){var c=this.options.state;c&&(this.controller.setState(c),this.views.parent.$el.removeClass("visible"))},render:function(){var c=this.options;c.text?this.$el.text(c.text):c.html&&this.$el.html(c.html);return this}});f.exports=e},{}],52:[function(e,f,g){var d=wp.media.view.PriorityList;e=d.extend({tagName:"div",className:"media-menu",property:"state",ItemView:wp.media.view.MenuItem,region:"menu",toView:function(c,
b){c=c||{};c[this.property]=c[this.property]||b;return(new this.ItemView(c)).render()},ready:function(){d.prototype.ready.apply(this,arguments);this.visibility()},set:function(){d.prototype.set.apply(this,arguments);this.visibility()},unset:function(){d.prototype.unset.apply(this,arguments);this.visibility()},visibility:function(){var c=this.region,b=this.controller[c].get(),a=this.views.get(),a=!a||2>a.length;this===b&&this.controller.$el.toggleClass("hide-"+c,a)},select:function(c){if(c=this.get(c))this.deselect(),
c.$el.addClass("active")},deselect:function(){this.$el.children().removeClass("active")},hide:function(c){(c=this.get(c))&&c.$el.addClass("hidden")},show:function(c){(c=this.get(c))&&c.$el.removeClass("hidden")}});f.exports=e},{}],53:[function(e,f,g){var d=jQuery;e=wp.media.View.extend({tagName:"div",template:wp.template("media-modal"),attributes:{tabindex:0},events:{"click .media-modal-backdrop, .media-modal-close":"escapeHandler",keydown:"keydown"},initialize:function(){_.defaults(this.options,
{container:document.body,title:"",propagate:!0,freeze:!0});this.focusManager=new wp.media.view.FocusManager({el:this.el})},prepare:function(){return{title:this.options.title}},attach:function(){if(this.views.attached)return this;this.views.rendered||this.render();this.$el.appendTo(this.options.container);this.views.attached=!0;this.views.ready();return this.propagate("attach")},detach:function(){this.$el.is(":visible")&&this.close();this.$el.detach();this.views.attached=!1;return this.propagate("detach")},
open:function(){var c=this.$el,b=this.options,a;if(c.is(":visible"))return this;this.views.attached||this.attach();b.freeze&&(this._freeze={scrollTop:d(window).scrollTop()});d("body").addClass("modal-open");c.show();"ontouchend"in document&&(a=window.tinymce&&window.tinymce.activeEditor)&&!a.isHidden()&&a.iframeElement&&(a.iframeElement.focus(),a.iframeElement.blur(),setTimeout(function(){a.iframeElement.blur()},100));this.$el.focus();return this.propagate("open")},close:function(c){var b=this._freeze;
if(!this.views.attached||!this.$el.is(":visible"))return this;d("body").removeClass("modal-open");this.$el.hide().undelegate("keydown");d("#wpbody-content").focus();this.propagate("close");b&&d(window).scrollTop(b.scrollTop);c&&c.escape&&this.propagate("escape");return this},escape:function(){return this.close({escape:!0})},escapeHandler:function(c){c.preventDefault();this.escape()},content:function(c){this.views.set(".media-modal-content",c);return this},propagate:function(c){this.trigger(c);this.options.propagate&&
this.controller.trigger(c);return this},keydown:function(c){27===c.which&&this.$el.is(":visible")&&(this.escape(),c.stopImmediatePropagation())}});f.exports=e},{}],54:[function(e,f,g){e=wp.media.View.extend({tagName:"div",initialize:function(){this._views={};this.set(_.extend({},this._views,this.options.views),{silent:!0});delete this.options.views;this.options.silent||this.render()},set:function(d,c,b){var a,e;b=b||{};if(_.isObject(d))return _.each(d,function(a,b){this.set(b,a)},this),this;c instanceof
Backbone.View||(c=this.toView(c,d,b));c.controller=c.controller||this.controller;this.unset(d);a=c.options.priority||10;b=this.views.get()||[];_.find(b,function(b,c){if(b.options.priority>a)return e=c,!0});this._views[d]=c;this.views.add(c,{at:_.isNumber(e)?e:b.length||0});return this},get:function(d){return this._views[d]},unset:function(d){var c=this.get(d);c&&c.remove();delete this._views[d];return this},toView:function(d){return new wp.media.View(d)}});f.exports=e},{}],55:[function(e,f,g){e=wp.media.view.MenuItem.extend({click:function(){var d=
this.options.contentMode;d&&this.controller.content.mode(d)}});f.exports=e},{}],56:[function(e,f,g){var d=wp.media.view.Menu;e=d.extend({tagName:"div",className:"media-router",property:"contentMode",ItemView:wp.media.view.RouterItem,region:"router",initialize:function(){this.controller.on("content:render",this.update,this);d.prototype.initialize.apply(this,arguments)},update:function(){var c=this.controller.content.mode();c&&this.select(c)}});f.exports=e},{}],57:[function(e,f,g){e=wp.media.View.extend({tagName:"input",
className:"search",id:"media-search-input",attributes:{type:"search",placeholder:wp.media.view.l10n.search},events:{input:"search",keyup:"search",change:"search",search:"search"},render:function(){this.el.value=this.model.escape("search");return this},search:function(d){d.target.value?this.model.set("search",d.target.value):this.model.unset("search")}});f.exports=e},{}],58:[function(e,f,g){var d=wp.media.view.l10n;e=wp.media.View.extend({tagName:"div",className:"media-selection",template:wp.template("media-selection"),
events:{"click .edit-selection":"edit","click .clear-selection":"clear"},initialize:function(){_.defaults(this.options,{editable:!1,clearable:!0});this.attachments=new wp.media.view.Attachments.Selection({controller:this.controller,collection:this.collection,selection:this.collection,model:new Backbone.Model});this.views.set(".selection-view",this.attachments);this.collection.on("add remove reset",this.refresh,this);this.controller.on("content:activate",this.refresh,this)},ready:function(){this.refresh()},
refresh:function(){if(this.$el.children().length){var c=this.collection,b="edit-selection"===this.controller.content.mode();this.$el.toggleClass("empty",!c.length);this.$el.toggleClass("one",1===c.length);this.$el.toggleClass("editing",b);this.$(".count").text(d.selected.replace("%d",c.length))}},edit:function(c){c.preventDefault();this.options.editable&&this.options.editable.call(this,this.collection)},clear:function(c){c.preventDefault();this.collection.reset();this.controller.modal.focusManager.focus()}});
f.exports=e},{}],59:[function(e,f,g){var d=wp.media.View,c=Backbone.$;e=d.extend({events:{"click button":"updateHandler","change input":"updateHandler","change select":"updateHandler","change textarea":"updateHandler"},initialize:function(){this.model=this.model||new Backbone.Model;this.listenTo(this.model,"change",this.updateChanges)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},render:function(){d.prototype.render.apply(this,arguments);_(this.model.attributes).chain().keys().each(this.update,
this);return this},update:function(b){var a=this.model.get(b),c=this.$('[data-setting="'+b+'"]');c.length&&(c.is("select")?(a=c.find('[value="'+a+'"]'),a.length?(c.find("option").prop("selected",!1),a.prop("selected",!0)):this.model.set(b,c.find(":selected").val())):c.hasClass("button-group")?(b=c.find("button").removeClass("active"),b.filter('[value="'+a+'"]').addClass("active")):c.is('input[type="text"], textarea')?c.is(":focus")||c.val(a):c.is('input[type="checkbox"]')&&c.prop("checked",!!a&&"false"!==
a))},updateHandler:function(b){var a=c(b.target).closest("[data-setting]"),d=b.target.value,e;b.preventDefault();a.length&&(a.is('input[type="checkbox"]')&&(d=a[0].checked),this.model.set(a.data("setting"),d),(e=a.data("userSetting"))&&window.setUserSetting(e,d))},updateChanges:function(b){b.hasChanged()&&_(b.changed).chain().keys().each(this.update,this)}});f.exports=e},{}],60:[function(e,f,g){var d=wp.media.view.Settings;e=d.extend({className:"attachment-display-settings",template:wp.template("attachment-display-settings"),
initialize:function(){var c=this.options.attachment;_.defaults(this.options,{userSettings:!1});d.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"change:link",this.updateLinkTo);if(c)c.on("change:uploading",this.render,this)},dispose:function(){var c=this.options.attachment;c&&c.off(null,null,this);d.prototype.dispose.apply(this,arguments)},render:function(){var c=this.options.attachment;c&&_.extend(this.options,{sizes:c.get("sizes"),type:c.get("type")});d.prototype.render.call(this);
this.updateLinkTo();return this},updateLinkTo:function(){var c=this.model.get("link"),b=this.$(".link-to-custom"),a=this.options.attachment;"none"===c||"embed"===c||!a&&"custom"!==c?b.addClass("hidden"):(a&&("post"===c?b.val(a.get("link")):"file"===c?b.val(a.get("url")):this.model.get("linkUrl")||b.val("http://"),b.prop("readonly","custom"!==c)),b.removeClass("hidden"),!wp.media.isTouchDevice&&b.is(":visible")&&b.focus()[0].select())}});f.exports=e},{}],61:[function(e,f,g){e=wp.media.view.Settings.extend({className:"collection-settings gallery-settings",
template:wp.template("gallery-settings")});f.exports=e},{}],62:[function(e,f,g){e=wp.media.view.Settings.extend({className:"collection-settings playlist-settings",template:wp.template("playlist-settings")});f.exports=e},{}],63:[function(e,f,g){e=wp.media.view.PriorityList.extend({className:"media-sidebar"});f.exports=e},{}],64:[function(e,f,g){var d=wp.media.view;e=d.Cropper.extend({className:"crop-content site-icon",ready:function(){d.Cropper.prototype.ready.apply(this,arguments);this.$(".crop-image").on("load",
_.bind(this.addSidebar,this))},addSidebar:function(){this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.sidebar.set("preview",new wp.media.view.SiteIconPreview({controller:this.controller,attachment:this.options.attachment}));this.controller.cropperView.views.add(this.sidebar)}});f.exports=e},{}],65:[function(e,f,g){var d=jQuery;e=wp.media.View.extend({className:"site-icon-preview",template:wp.template("site-icon-preview"),ready:function(){this.controller.imgSelect.setOptions({onInit:this.updatePreview,
onSelectChange:this.updatePreview})},prepare:function(){return{url:this.options.attachment.get("url")}},updatePreview:function(c,b){var a=64/b.width,e=64/b.height,f=16/b.width,g=16/b.height;d("#preview-app-icon").css({width:Math.round(a*this.imageWidth)+"px",height:Math.round(e*this.imageHeight)+"px",marginLeft:"-"+Math.round(a*b.x1)+"px",marginTop:"-"+Math.round(e*b.y1)+"px"});d("#preview-favicon").css({width:Math.round(f*this.imageWidth)+"px",height:Math.round(g*this.imageHeight)+"px",marginLeft:"-"+
Math.round(f*b.x1)+"px",marginTop:"-"+Math.floor(g*b.y1)+"px"})}});f.exports=e},{}],66:[function(e,f,g){e=wp.media.View.extend({tagName:"span",className:"spinner",spinnerTimeout:!1,delay:400,show:function(){this.spinnerTimeout||(this.spinnerTimeout=_.delay(function(d){d.addClass("is-active")},this.delay,this.$el));return this},hide:function(){this.$el.removeClass("is-active");this.spinnerTimeout=clearTimeout(this.spinnerTimeout);return this}});f.exports=e},{}],67:[function(e,f,g){var d=wp.media.View;
e=d.extend({tagName:"div",className:"media-toolbar",initialize:function(){var c=this.controller.state(),b=this.selection=c.get("selection"),c=this.library=c.get("library");this._views={};this.primary=new wp.media.view.PriorityList;this.secondary=new wp.media.view.PriorityList;this.primary.$el.addClass("media-toolbar-primary search-form");this.secondary.$el.addClass("media-toolbar-secondary");this.views.set([this.secondary,this.primary]);this.options.items&&this.set(this.options.items,{silent:!0});
this.options.silent||this.render();if(b)b.on("add remove reset",this.refresh,this);if(c)c.on("add remove reset",this.refresh,this)},dispose:function(){this.selection&&this.selection.off(null,null,this);this.library&&this.library.off(null,null,this);return d.prototype.dispose.apply(this,arguments)},ready:function(){this.refresh()},set:function(c,b,a){var d;a=a||{};_.isObject(c)?_.each(c,function(a,b){this.set(b,a,{silent:!0})},this):(b instanceof Backbone.View||(b.classes=["media-button-"+c].concat(b.classes||
[]),b=(new wp.media.view.Button(b)).render()),b.controller=b.controller||this.controller,this._views[c]=b,d=0>b.options.priority?"secondary":"primary",this[d].set(c,b,a));a.silent||this.refresh();return this},get:function(c){return this._views[c]},unset:function(c,b){delete this._views[c];this.primary.unset(c,b);this.secondary.unset(c,b);b&&b.silent||this.refresh();return this},refresh:function(){var c=this.controller.state(),b=c.get("library"),a=c.get("selection");_.each(this._views,function(c){if(c.model&&
c.options&&c.options.requires){var d=c.options.requires,e=!1,e=_.some(a.models,function(a){return!0===a.get("uploading")});d.selection&&a&&!a.length?e=!0:d.library&&b&&!b.length&&(e=!0);c.model.set("disabled",e)}})}});f.exports=e},{}],68:[function(e,f,g){var d=wp.media.view.Toolbar.Select,c=wp.media.view.l10n;e=d.extend({initialize:function(){_.defaults(this.options,{text:c.insertIntoPost,requires:!1});d.prototype.initialize.apply(this,arguments)},refresh:function(){var b=this.controller.state().props.get("url");
this.get("select").model.set("disabled",!b||"http://"===b);d.prototype.refresh.apply(this,arguments)}});f.exports=e},{}],69:[function(e,f,g){var d=wp.media.view.Toolbar,c=wp.media.view.l10n;e=d.extend({initialize:function(){var b=this.options;_.bindAll(this,"clickSelect");_.defaults(b,{event:"select",state:!1,reset:!0,close:!0,text:c.select,requires:{selection:!0}});b.items=_.defaults(b.items||{},{select:{style:"primary",text:b.text,priority:80,click:this.clickSelect,requires:b.requires}});d.prototype.initialize.apply(this,
arguments)},clickSelect:function(){var b=this.options,a=this.controller;b.close&&a.close();b.event&&a.state().trigger(b.event);b.state&&a.setState(b.state);b.reset&&a.reset()}});f.exports=e},{}],70:[function(e,f,g){var d=wp.media.View,c=wp.media.view.l10n,b=jQuery;e=d.extend({tagName:"div",className:"uploader-editor",template:wp.template("uploader-editor"),localDrag:!1,overContainer:!1,overDropzone:!1,draggingFile:null,initialize:function(){this.initialized=!1;if(!window.tinyMCEPreInit||!window.tinyMCEPreInit.dragDropUpload||
!this.browserSupport())return this;this.$document=b(document);this.dropzones=[];this.files=[];this.$document.on("drop",".uploader-editor",_.bind(this.drop,this));this.$document.on("dragover",".uploader-editor",_.bind(this.dropzoneDragover,this));this.$document.on("dragleave",".uploader-editor",_.bind(this.dropzoneDragleave,this));this.$document.on("click",".uploader-editor",_.bind(this.click,this));this.$document.on("dragover",_.bind(this.containerDragover,this));this.$document.on("dragleave",_.bind(this.containerDragleave,
this));this.$document.on("dragstart dragend drop",_.bind(function(a){this.localDrag="dragstart"===a.type},this));this.initialized=!0;return this},browserSupport:function(){var a=!1,a=document.createElement("div");return a=("draggable"in a||"ondragstart"in a&&"ondrop"in a)&&!!(window.File&&window.FileList&&window.FileReader)},isDraggingFile:function(a){return null!==this.draggingFile?this.draggingFile:_.isUndefined(a.originalEvent)||_.isUndefined(a.originalEvent.dataTransfer)?!1:this.draggingFile=
-1<_.indexOf(a.originalEvent.dataTransfer.types,"Files")&&-1===_.indexOf(a.originalEvent.dataTransfer.types,"text/plain")},refresh:function(a){for(var c in this.dropzones)this.dropzones[c].toggle(this.overContainer||this.overDropzone);_.isUndefined(a)||b(a.target).closest(".uploader-editor").toggleClass("droppable",this.overDropzone);this.overContainer||this.overDropzone||(this.draggingFile=null);return this},render:function(){if(!this.initialized)return this;d.prototype.render.apply(this,arguments);
b(".wp-editor-wrap").each(_.bind(this.attach,this));return this},attach:function(a,c){var d=this.$el.clone();this.dropzones.push(d);b(c).append(d);return this},drop:function(a){this.containerDragleave(a);this.dropzoneDragleave(a);this.files=a.originalEvent.dataTransfer.files;if(!(1>this.files.length)){a=b(a.target).parents(".wp-editor-wrap");0<a.length&&a[0].id&&(window.wpActiveEditor=a[0].id.slice(3,-5));if(this.workflow)this.workflow.state().reset(),this.addFiles.apply(this),this.workflow.open();
else if(this.workflow=wp.media.editor.open(window.wpActiveEditor,{frame:"post",state:"insert",title:c.addMedia,multiple:!0}),a=this.workflow.uploader,a.uploader&&a.uploader.ready)this.addFiles.apply(this);else this.workflow.on("uploader:ready",this.addFiles,this);return!1}},addFiles:function(){this.files.length&&(this.workflow.uploader.uploader.uploader.addFile(_.toArray(this.files)),this.files=[]);return this},containerDragover:function(a){!this.localDrag&&this.isDraggingFile(a)&&(this.overContainer=
!0,this.refresh())},containerDragleave:function(){this.overContainer=!1;_.delay(_.bind(this.refresh,this),50)},dropzoneDragover:function(a){if(!this.localDrag&&this.isDraggingFile(a))return this.overDropzone=!0,this.refresh(a),!1},dropzoneDragleave:function(a){this.overDropzone=!1;_.delay(_.bind(this.refresh,this,a),50)},click:function(a){this.containerDragleave(a);this.dropzoneDragleave(a);this.localDrag=!1}});f.exports=e},{}],71:[function(e,f,g){var d=wp.media.View;e=d.extend({tagName:"div",className:"uploader-inline",
template:wp.template("uploader-inline"),events:{"click .close":"hide"},initialize:function(){_.defaults(this.options,{message:"",status:!0,canClose:!1});!this.options.$browser&&this.controller.uploader&&(this.options.$browser=this.controller.uploader.$browser);_.isUndefined(this.options.postId)&&(this.options.postId=wp.media.view.settings.post.id);this.options.status&&this.views.set(".upload-inline-status",new wp.media.view.UploaderStatus({controller:this.controller}))},prepare:function(){var c=this.controller.state().get("suggestedWidth"),
b=this.controller.state().get("suggestedHeight"),a={};a.message=this.options.message;a.canClose=this.options.canClose;c&&b&&(a.suggestedWidth=c,a.suggestedHeight=b);return a},dispose:function(){if(this.disposing)return d.prototype.dispose.apply(this,arguments);this.disposing=!0;return this.remove()},remove:function(){var c=d.prototype.remove.apply(this,arguments);_.defer(_.bind(this.refresh,this));return c},refresh:function(){var c=this.controller.uploader;c&&c.refresh()},ready:function(){var c=this.options.$browser,
b;if(this.controller.uploader){b=this.$(".browser");if(b[0]===c[0])return;c.detach().text(b.text());c[0].className=b[0].className;b.replaceWith(c.show())}this.refresh();return this},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}});f.exports=e},{}],72:[function(e,f,g){e=wp.media.View.extend({className:"upload-error",template:wp.template("uploader-status-error")});f.exports=e},{}],73:[function(e,f,g){var d=wp.media.View;e=d.extend({className:"media-uploader-status",
template:wp.template("uploader-status"),events:{"click .upload-dismiss-errors":"dismiss"},initialize:function(){this.queue=wp.Uploader.queue;this.queue.on("add remove reset",this.visibility,this);this.queue.on("add remove reset change:percent",this.progress,this);this.queue.on("add remove reset change:uploading",this.info,this);this.errors=wp.Uploader.errors;this.errors.reset();this.errors.on("add remove reset",this.visibility,this);this.errors.on("add",this.error,this)},dispose:function(){wp.Uploader.queue.off(null,
null,this);d.prototype.dispose.apply(this,arguments);return this},visibility:function(){this.$el.toggleClass("uploading",!!this.queue.length);this.$el.toggleClass("errors",!!this.errors.length);this.$el.toggle(!!this.queue.length||!!this.errors.length)},ready:function(){_.each({$bar:".media-progress-bar div",$index:".upload-index",$total:".upload-total",$filename:".upload-filename"},function(c,b){this[b]=this.$(c)},this);this.visibility();this.progress();this.info()},progress:function(){var c=this.queue,
b=this.$bar;b&&c.length&&b.width(c.reduce(function(a,b){if(!b.get("uploading"))return a+100;var c=b.get("percent");return a+(_.isNumber(c)?c:100)},0)/c.length+"%")},info:function(){var c=this.queue,b=0,a;c.length&&(a=this.queue.find(function(a,c){b=c;return a.get("uploading")}),this.$index.text(b+1),this.$total.text(c.length),this.$filename.html(a?this.filename(a.get("filename")):""))},filename:function(c){return _.escape(c)},error:function(c){this.views.add(".upload-errors",new wp.media.view.UploaderStatusError({filename:this.filename(c.get("file").name),
message:c.get("message")}),{at:0})},dismiss:function(c){var b=this.views.get(".upload-errors");c.preventDefault();b&&_.invoke(b,"remove");wp.Uploader.errors.reset()}});f.exports=e},{}],74:[function(e,f,g){var d=jQuery;e=wp.media.View.extend({tagName:"div",className:"uploader-window",template:wp.template("uploader-window"),initialize:function(){var c;this.$browser=d('<a href="#" class="browser" />').hide().appendTo("body");c=this.options.uploader=_.defaults(this.options.uploader||{},{dropzone:this.$el,
browser:this.$browser,params:{}});!c.dropzone||c.dropzone instanceof d||(c.dropzone=d(c.dropzone));this.controller.on("activate",this.refresh,this);this.controller.on("detach",function(){this.$browser.remove()},this)},refresh:function(){this.uploader&&this.uploader.refresh()},ready:function(){var c=wp.media.view.settings.post.id;this.uploader||(c&&(this.options.uploader.params.post_id=c),this.uploader=new wp.Uploader(this.options.uploader),c=this.uploader.dropzone,c.on("dropzone:enter",_.bind(this.show,
this)),c.on("dropzone:leave",_.bind(this.hide,this)),d(this.uploader).on("uploader:ready",_.bind(this._ready,this)))},_ready:function(){this.controller.trigger("uploader:ready")},show:function(){var c=this.$el.show();_.defer(function(){c.css({opacity:1})})},hide:function(){var c=this.$el.css({opacity:0});wp.media.transition(c).done(function(){"0"===c.css("opacity")&&c.hide()});_.delay(function(){"0"===c.css("opacity")&&c.is(":visible")&&c.hide()},500)}});f.exports=e},{}],75:[function(e,f,g){e=wp.Backbone.View.extend({constructor:function(d){d&&
d.controller&&(this.controller=d.controller);wp.Backbone.View.apply(this,arguments)},dispose:function(){this.undelegateEvents();this.model&&this.model.off&&this.model.off(null,null,this);this.collection&&this.collection.off&&this.collection.off(null,null,this);this.controller&&this.controller.off&&this.controller.off(null,null,this);return this},remove:function(){this.dispose();return wp.Backbone.View.prototype.remove.apply(this,arguments)}});f.exports=e},{}]},{},[19]);
