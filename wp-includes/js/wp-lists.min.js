(function(c){var n={add:"ajaxAdd",del:"ajaxDel",dim:"ajaxDim",process:"process",recolor:"recolor"},g;g={settings:{url:ajaxurl,type:"POST",response:"ajax-response",what:"",alt:"alternate",altOffset:0,addColor:null,delColor:null,dimAddColor:null,dimDelColor:null,confirm:null,addBefore:null,addAfter:null,delBefore:null,delAfter:null,dimBefore:null,dimAfter:null},nonce:function(b,a){var d=wpAjax.unserialize(b.attr("href"));return a.nonce||d._ajax_nonce||c("#"+a.element+' input[name="_ajax_nonce"]').val()||
d._wpnonce||c("#"+a.element+' input[name="_wpnonce"]').val()||0},parseData:function(b,a){var d=[],e;try{e=c(b).attr("data-wp-lists")||"",(e=e.match(new RegExp(a+":[\\S]+")))&&(d=e[0].split(":"))}catch(f){}return d},pre:function(b,a,d){var e;a=c.extend({},this.wpList.settings,{element:null,nonce:0,target:b.get(0)},a||{});return c.isFunction(a.confirm)&&("add"!=d&&(e=c("#"+a.element).css("backgroundColor"),c("#"+a.element).css("backgroundColor","#FF9966")),b=a.confirm.call(this,b,a,d,e),"add"!=d&&c("#"+
a.element).css("backgroundColor",e),!b)?!1:a},ajaxAdd:function(b,a){b=c(b);a=a||{};var d=this,e=g.parseData(b,"add"),f,h,k;a=g.pre.call(d,b,a,"add");a.element=e[2]||b.attr("id")||a.element||null;a.addColor=e[3]?"#"+e[3]:a.addColor||"#FFFF33";if(!a)return!1;if(!b.is('[id="'+a.element+'-submit"]'))return!g.add.call(d,b,a);if(!a.element)return!0;a.action="add-"+a.what;a.nonce=g.nonce(b,a);f=c("#"+a.element+" :input").not('[name="_ajax_nonce"], [name="_wpnonce"], [name="action"]');if(!wpAjax.validateForm("#"+
a.element))return!1;a.data=c.param(c.extend({_ajax_nonce:a.nonce,action:a.action},wpAjax.unserialize(e[4]||"")));if(e=c.isFunction(f.fieldSerialize)?f.fieldSerialize():f.serialize())a.data+="&"+e;if(c.isFunction(a.addBefore)&&(a=a.addBefore(a),!a)||!a.data.match(/_ajax_nonce=[a-f0-9]+/))return!0;a.success=function(b){h=wpAjax.parseAjaxResponse(b,a.response,a.element);k=b;if(!h||h.errors)return!1;if(!0===h)return!0;jQuery.each(h.responses,function(){g.add.call(d,this.data,c.extend({},a,{pos:this.position||
0,id:this.id||0,oldId:this.oldId||null}))});d.wpList.recolor();c(d).trigger("wpListAddEnd",[a,d.wpList]);g.clear.call(d,"#"+a.element)};a.complete=function(b,d){if(c.isFunction(a.addAfter)){var e=c.extend({xml:b,status:d,parsed:h},a);a.addAfter(k,e)}};c.ajax(a);return!1},ajaxDel:function(b,a){b=c(b);a=a||{};var d=this,e=g.parseData(b,"delete"),f,h,k;a=g.pre.call(d,b,a,"delete");a.element=e[2]||a.element||null;a.delColor=e[3]?"#"+e[3]:a.delColor||"#faa";if(!a||!a.element)return!1;a.action="delete-"+
a.what;a.nonce=g.nonce(b,a);a.data=c.extend({action:a.action,id:a.element.split("-").pop(),_ajax_nonce:a.nonce},wpAjax.unserialize(e[4]||""));if(c.isFunction(a.delBefore)&&(a=a.delBefore(a,d),!a)||!a.data._ajax_nonce)return!0;f=c("#"+a.element);"none"!=a.delColor?f.css("backgroundColor",a.delColor).fadeOut(350,function(){d.wpList.recolor();c(d).trigger("wpListDelEnd",[a,d.wpList])}):(d.wpList.recolor(),c(d).trigger("wpListDelEnd",[a,d.wpList]));a.success=function(b){h=wpAjax.parseAjaxResponse(b,a.response,
a.element);k=b;if(!h||h.errors)return f.stop().stop().css("backgroundColor","#faa").show().queue(function(){d.wpList.recolor();c(this).dequeue()}),!1};a.complete=function(b,d){c.isFunction(a.delAfter)&&f.queue(function(){var e=c.extend({xml:b,status:d,parsed:h},a);a.delAfter(k,e)}).dequeue()};c.ajax(a);return!1},ajaxDim:function(b,a){if("none"==c(b).parent().css("display"))return!1;b=c(b);a=a||{};var d=this,e=g.parseData(b,"dim"),f,h,k,l,m;a=g.pre.call(d,b,a,"dim");a.element=e[2]||a.element||null;
a.dimClass=e[3]||a.dimClass||null;a.dimAddColor=e[4]?"#"+e[4]:a.dimAddColor||"#FFFF33";a.dimDelColor=e[5]?"#"+e[5]:a.dimDelColor||"#FF3333";if(!a||!a.element||!a.dimClass)return!0;a.action="dim-"+a.what;a.nonce=g.nonce(b,a);a.data=c.extend({action:a.action,id:a.element.split("-").pop(),dimClass:a.dimClass,_ajax_nonce:a.nonce},wpAjax.unserialize(e[6]||""));if(c.isFunction(a.dimBefore)&&(a=a.dimBefore(a),!a))return!0;f=c("#"+a.element);h=f.toggleClass(a.dimClass).is("."+a.dimClass);e=g.getColor(f);
f.toggleClass(a.dimClass);k=h?a.dimAddColor:a.dimDelColor;"none"!=k?f.animate({backgroundColor:k},"fast").queue(function(){f.toggleClass(a.dimClass);c(this).dequeue()}).animate({backgroundColor:e},{complete:function(){c(this).css("backgroundColor","");c(d).trigger("wpListDimEnd",[a,d.wpList])}}):c(d).trigger("wpListDimEnd",[a,d.wpList]);if(!a.data._ajax_nonce)return!0;a.success=function(b){l=wpAjax.parseAjaxResponse(b,a.response,a.element);m=b;if(!l||l.errors)return f.stop().stop().css("backgroundColor",
"#FF3333")[h?"removeClass":"addClass"](a.dimClass).show().queue(function(){d.wpList.recolor();c(this).dequeue()}),!1};a.complete=function(b,d){c.isFunction(a.dimAfter)&&f.queue(function(){var e=c.extend({xml:b,status:d,parsed:l},a);a.dimAfter(m,e)}).dequeue()};c.ajax(a);return!1},getColor:function(b){return jQuery(b).css("backgroundColor")||"#ffffff"},add:function(b,a){b="string"==typeof b?c(c.trim(b)):c(b);var d=c(this),e=!1,f;"string"==typeof a&&(a={what:a});a=c.extend({pos:0,id:0,oldId:null},this.wpList.settings,
a);if(!b.size()||!a.what)return!1;a.oldId&&(e=c("#"+a.what+"-"+a.oldId));!a.id||a.id==a.oldId&&e&&e.size()||c("#"+a.what+"-"+a.id).remove();if(e&&e.size())e.before(b),e.remove();else if(isNaN(a.pos))if(e="after","-"==a.pos.substr(0,1)&&(a.pos=a.pos.substr(1),e="before"),f=d.find("#"+a.pos),1===f.size())f[e](b);else d.append(b);else if("comment"!=a.what||0===c("#"+a.element).length)0>a.pos?d.prepend(b):d.append(b);a.alt&&((d.children(":visible").index(b[0])+a.altOffset)%2?b.removeClass(a.alt):b.addClass(a.alt));
"none"!=a.addColor&&(e=g.getColor(b),b.css("backgroundColor",a.addColor).animate({backgroundColor:e},{complete:function(){c(this).css("backgroundColor","")}}));d.each(function(){this.wpList.process(b)});return b},clear:function(b){var a,d;b=c(b);this.wpList&&b.parents("#"+this.id).size()||b.find(":input").each(function(){c(this).parents(".form-no-clear").size()||(a=this.type.toLowerCase(),d=this.tagName.toLowerCase(),"text"==a||"password"==a||"textarea"==d?this.value="":"checkbox"==a||"radio"==a?
this.checked=!1:"select"==d&&(this.selectedIndex=null))})},process:function(b){var a=this;b=c(b||document);b.delegate('form[data-wp-lists^="add:'+a.id+':"]',"submit",function(){return a.wpList.add(this)});b.delegate('a[data-wp-lists^="add:'+a.id+':"], input[data-wp-lists^="add:'+a.id+':"]',"click",function(){return a.wpList.add(this)});b.delegate('[data-wp-lists^="delete:'+a.id+':"]',"click",function(){return a.wpList.del(this)});b.delegate('[data-wp-lists^="dim:'+a.id+':"]',"click",function(){return a.wpList.dim(this)})},
recolor:function(){var b,a;this.wpList.settings.alt&&(b=c(".list-item:visible",this),b.size()||(b=c(this).children(":visible")),a=[":even",":odd"],this.wpList.settings.altOffset%2&&a.reverse(),b.filter(a[0]).addClass(this.wpList.settings.alt).end().filter(a[1]).removeClass(this.wpList.settings.alt))},init:function(){var b=this;b.wpList.process=function(a){b.each(function(){this.wpList.process(a)})};b.wpList.recolor=function(){b.each(function(){this.wpList.recolor()})}}};c.fn.wpList=function(b){this.each(function(){var a=
this;this.wpList={settings:c.extend({},g.settings,{what:g.parseData(this,"list")[1]||""},b)};c.each(n,function(b,c){a.wpList[b]=function(b,d){return g[c].call(a,b,d)}})});g.init.call(this);this.wpList.process();return this}})(jQuery);
