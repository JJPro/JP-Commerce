(function(b){function q(){"function"!==typeof zxcvbn?setTimeout(q,50):(a.val(a.data("pw")),a.trigger("pwupdate").trigger("wp-check-valid-field"),1!==parseInt(f.data("start-masked"),10)?l.addClass("show-password"):f.trigger("click"))}function x(){var d=b("#pass-strength-result")[0];g=a.val();l=a.parent();c=b('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(a[0].className).data("pw",a.data("pw")).val(a.val()).on(m,function(){c.val()!==g&&(e.val(c.val()),
a.val(c.val()).trigger("pwupdate"),g=c.val())});a.after(c);1===parseInt(a.data("reveal"),10)&&q();a.on(m+" pwupdate",function(){a.val()!==g&&(g=a.val(),c.val()!==g&&c.val(g),a.add(c).removeClass("short bad good strong"),d.className&&(a.add(c).addClass(d.className),"short"===d.className||"bad"===d.className?(r.prop("checked")||n.prop("disabled",!0),t.show()):(n.prop("disabled",!1),t.hide())))})}function v(){f.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden");
c.focus();u.attr("for","pass1-text")}function y(){f=k.find(".wp-hide-pw");f.show().on("click",function(){1===parseInt(f.data("toggle"),10)?(l.addClass("show-password"),v(),_.isUndefined(c[0].setSelectionRange)||c[0].setSelectionRange(0,100)):(l.removeClass("show-password"),f.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),a.focus(),u.attr("for","pass1"),
_.isUndefined(a[0].setSelectionRange)||a[0].setSelectionRange(0,100))})}function z(){var d,h;k=b(".user-pass1-wrap");u=k.find("th label").attr("for","pass1-text");b(".user-pass2-wrap").hide();w=b("#submit").on("click",function(){p=!1});n=w.add(" #createusersub");t=b(".pw-weak");r=t.find(".pw-checkbox");r.change(function(){n.prop("disabled",!r.prop("checked"))});a=b("#pass1");a.length&&x();e=b("#pass2").on(m,function(){0<e.val().length&&(a.val(e.val()),e.val(""),g="",a.trigger("pwupdate"))});a.is(":hidden")&&
(a.prop("disabled",!0),e.prop("disabled",!0),c.prop("disabled",!0));d=k.find(".wp-pwd");h=k.find("button.wp-generate-pw");y();h.length&&d.hide();h.show();h.on("click",function(){p=!0;h.hide();d.show();a.attr("disabled",!1);e.attr("disabled",!1);c.attr("disabled",!1);0===c.val().length&&q();_.defer(function(){c.focus();_.isUndefined(c[0].setSelectionRange)||c[0].setSelectionRange(0,100)},0)});k.find("button.wp-cancel-pw").on("click",function(){p=!1;c.val("");wp.ajax.post("generate-password").done(function(b){a.data("pw",
b)});h.show();d.hide();a.prop("disabled",!0);e.prop("disabled",!0);c.prop("disabled",!0);v();a.val("").trigger("pwupdate");n.prop("disabled",!1)});k.closest("form").on("submit",function(){p=!1;a.prop("disabled",!1);e.prop("disabled",!1);e.val(a.val());l.removeClass("show-password")})}function A(){var a=b("#pass1").val();b("#pass-strength-result").removeClass("short bad good strong");if(a)switch(a=wp.passwordStrength.meter(a,wp.passwordStrength.userInputBlacklist(),a),a){case 2:b("#pass-strength-result").addClass("bad").html(pwsL10n.bad);
break;case 3:b("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:b("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:b("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:b("#pass-strength-result").addClass("short").html(pwsL10n["short"])}else b("#pass-strength-result").html("&nbsp;")}var p=!1,k,l,a,c,u,e,t,r,f,n,w,g,m;m="oninput"in document.createElement("input")?"input":"keyup";b(document).ready(function(){var a,c,e,
g,f=b("#display_name");b("#pass1").val("").on(m+" pwupdate",A);b("#pass-strength-result").show();b(".color-palette").click(function(){b(this).siblings('input[name="admin_color"]').prop("checked",!0)});f.length&&b("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var a=[],c={display_nickname:b("#nickname").val()||"",display_username:b("#user_login").val()||"",display_firstname:b("#first_name").val()||"",display_lastname:b("#last_name").val()||""};c.display_firstname&&c.display_lastname&&
(c.display_firstlast=c.display_firstname+" "+c.display_lastname,c.display_lastfirst=c.display_lastname+" "+c.display_firstname);b.each(b("option",f),function(b,c){a.push(c.value)});b.each(c,function(e,h){if(h){var d=h.replace(/<\/?[a-z][^>]*>/gi,"");c[e].length&&-1===b.inArray(d,a)&&(a.push(d),b("<option />",{text:d}).appendTo(f))}})});a=b("#color-picker");c=b("#colors-css");e=b("input#user_id").val();g=b('input[name="checkuser_id"]').val();a.on("click.colorpicker",".color-option",function(){var a,
d=b(this);if(!d.hasClass("selected")&&(d.siblings(".selected").removeClass("selected"),d.addClass("selected").find('input[type="radio"]').prop("checked",!0),e===g)){0===c.length&&(c=b('<link rel="stylesheet" />').appendTo("head"));c.attr("href",d.children(".css_url").val());if("undefined"!==typeof wp&&wp.svgPainter){try{a=b.parseJSON(d.children(".icon_colors").val())}catch(f){}a&&(wp.svgPainter.setColors(a),wp.svgPainter.paint())}b.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:d.children('input[name="admin_color"]').val(),
nonce:b("#color-nonce").val()}).done(function(a){a.success&&b("body").removeClass(a.data.previousScheme).addClass(a.data.currentScheme)})}});z()});b("#destroy-sessions").on("click",function(a){var c=b(this);wp.ajax.post("destroy-sessions",{nonce:b("#_wpnonce").val(),user_id:b("#user_id").val()}).done(function(a){c.prop("disabled",!0);c.siblings(".notice").remove();c.before('<div class="notice notice-success inline"><p>'+a.message+"</p></div>")}).fail(function(a){c.siblings(".notice").remove();c.before('<div class="notice notice-error inline"><p>'+
a.message+"</p></div>")});a.preventDefault()});window.generatePassword=q;b(window).on("beforeunload",function(){if(!0===p)return userProfileL10n.warn})})(jQuery);
