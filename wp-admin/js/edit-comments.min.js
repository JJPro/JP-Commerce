var setCommentsList,theList,theExtraList,commentReply;
(function(a){var p,k,x,y,z,D,A,E=document.title,B=a("#dashboard_right_now").length,n,v;p=function(a){a=parseInt(a.html().replace(/[^0-9]+/g,""),10);return isNaN(a)?0:a};k=function(a,c){var e="";if(!isNaN(c)){c=1>c?"0":c.toString();if(3<c.length){for(;3<c.length;)e=thousandsSeparator+c.substr(c.length-3)+e,c=c.substr(0,c.length-3);c+=e}a.html(c)}};z=function(b,c){var e=".post-com-count-"+c,d;x("span.approved-count",b);c&&(d=a("span.comment-count-approved",e),e=a("span.comment-count-no-comments",e),
d.each(function(){var c=a(this),d=p(c)+b;1>d&&(d=0);0===d?c.removeClass("comment-count-approved").addClass("comment-count-no-comments"):c.addClass("comment-count-approved").removeClass("comment-count-no-comments");k(c,d)}),e.each(function(){var c=a(this);0<b?c.removeClass("comment-count-no-comments").addClass("comment-count-approved"):c.addClass("comment-count-no-comments").removeClass("comment-count-approved");k(c,b)}))};x=function(b,c){a(b).each(function(){var b=a(this),d=p(b)+c;1>d&&(d=0);k(b,
d)})};A=function(b){if(B&&b&&b.i18n_comments_text){var c=a("#dashboard_right_now");a(".comment-count a",c).text(b.i18n_comments_text);a(".comment-mod-count a",c).text(b.i18n_moderation_text).parent()[0<b.in_moderation?"removeClass":"addClass"]("hidden")}};D=function(b){var c,e;v=v||new RegExp(adminCommentsL10n.docTitleCommentsCount.replace("%s","\\([0-9"+thousandsSeparator+"]+\\)")+"?");n=n||a("<div />");c=E;(e=v.exec(document.title))?(e=e[0],n.html(e),b=p(n)+b):n.html(0);1<=b?(k(n,b),(b=v.exec(document.title))&&
(c=document.title.replace(b[0],adminCommentsL10n.docTitleCommentsCount.replace("%s",n.text())+" "))):(b=v.exec(c))&&(c=c.replace(b[0],adminCommentsL10n.docTitleComments));document.title=c};y=function(b,c){var e=".post-com-count-"+c,d;B||D(b);a("span.pending-count").each(function(){var c=a(this),d=p(c)+b;1>d&&(d=0);c.closest(".awaiting-mod")[0===d?"addClass":"removeClass"]("count-0");k(c,d)});c&&(d=a("span.comment-count-pending",e),e=a("span.comment-count-no-pending",e),d.each(function(){var c=a(this),
d=p(c)+b;1>d&&(d=0);0===d?(c.parent().addClass("post-com-count-no-pending"),c.removeClass("comment-count-pending").addClass("comment-count-no-pending")):(c.parent().removeClass("post-com-count-no-pending"),c.addClass("comment-count-pending").removeClass("comment-count-no-pending"));k(c,d)}),e.each(function(){var c=a(this);0<b?(c.parent().removeClass("post-com-count-no-pending"),c.removeClass("comment-count-no-pending").addClass("comment-count-pending")):(c.parent().addClass("post-com-count-no-pending"),
c.addClass("comment-count-no-pending").removeClass("comment-count-pending"));k(c,b)}))};setCommentsList=function(){var b,c,e,d,t,u,C=0;b=a('input[name="_total"]',"#comments-form");c=a('input[name="_per_page"]',"#comments-form");e=a('input[name="_page"]',"#comments-form");d=function(a,c,d){c<C||(d&&(C=c),b.val(a.toString()))};t=function(c){var b=a.query.get(),d=a(".total-pages").text(),g=a('input[name="_per_page"]',"#comments-form").val();b.paged||(b.paged=1);b.paged>d||(c?(theExtraList.empty(),b.number=
Math.min(8,g)):(b.number=1,b.offset=Math.min(8,g)-1),b.no_placeholder=!0,b.paged++,!0===b.comment_type&&(b.comment_type=""),b=a.extend(b,{action:"fetch-list",list_args:list_args,_ajax_fetch_list_nonce:a("#_ajax_fetch_list_nonce").val()}),a.ajax({url:ajaxurl,global:!1,dataType:"json",data:b,success:function(a){theExtraList.get(0).wpList.add(a.rows)}}))};theExtraList=a("#the-extra-comment-list").wpList({alt:"",delColor:"none",addColor:"none"});theList=a("#the-comment-list").wpList({alt:"",delBefore:function(d,
F){var l,g,f,t,h,m=!1;f=a(d.target).attr("data-wp-lists");d.data._total=b.val()||0;d.data._per_page=c.val()||0;d.data._page=e.val()||0;d.data._url=document.location.href;d.data.comment_status=a('input[name="comment_status"]',"#comments-form").val();-1!=f.indexOf(":trash=1")?m="trash":-1!=f.indexOf(":spam=1")&&(m="spam");m&&(g=f.replace(/.*?comment-([0-9]+).*/,"$1"),f=a("#comment-"+g),l=a("#"+m+"-undo-holder").html(),f.find(".check-column :checkbox").prop("checked",!1),f.siblings("#replyrow").length&&
commentReply.cid==g&&commentReply.close(),f.is("tr")?(t=f.children(":visible").length,h=a(".author strong",f).text(),l=a('<tr id="undo-'+g+'" class="undo un'+m+'" style="display:none;"><td colspan="'+t+'">'+l+"</td></tr>")):(h=a(".comment-author",f).text(),l=a('<div id="undo-'+g+'" style="display:none;" class="undo un'+m+'">'+l+"</div>")),f.before(l),a("strong","#undo-"+g).text(h),h=a(".undo a","#undo-"+g),h.attr("href","comment.php?action=un"+m+"comment&c="+g+"&_wpnonce="+d.data._ajax_nonce),h.attr("data-wp-lists",
"delete:the-comment-list:comment-"+g+"::un"+m+"=1"),h.attr("class","vim-z vim-destructive"),a(".avatar",f).first().clone().prependTo("#undo-"+g+" ."+m+"-undo-inside"),h.click(function(c){c.preventDefault();F.wpList.del(this);a("#undo-"+g).css({backgroundColor:"#ceb"}).fadeOut(350,function(){a(this).remove();a("#comment-"+g).css("backgroundColor","").fadeIn(300,function(){a(this).show()})})}));return d},dimAfter:function(c,b){var d,g,f,e=a("#"+b.element);!0!==b.parsed&&(f=b.parsed.responses[0]);d=
a("#replyrow");g=a("#comment_ID",d).val();d=a("#replybtn",d);e.is(".unapproved")?(b.data.id==g&&d.text(adminCommentsL10n.replyApprove),e.find("div.comment_status").html("0")):(b.data.id==g&&d.text(adminCommentsL10n.reply),e.find("div.comment_status").html("1"));u=a("#"+b.element).is("."+b.dimClass)?1:-1;f?(A(f.supplemental),y(u,f.supplemental.postId),z(-1*u,f.supplemental.postId)):(y(u),z(-1*u))},delAfter:function(c,e){var l,g,f;f=!0===e.parsed?{}:e.parsed.responses[0];l=!0===e.parsed?"":f.supplemental.status;
g=!0===e.parsed?"":f.supplemental.postId;var u=!0===e.parsed?"":f.supplemental,h=a(e.target).parent(),m=a("#"+e.element),k,w,q,r,n=m.hasClass("approved"),p=m.hasClass("unapproved"),v=m.hasClass("spam"),m=m.hasClass("trash");A(u);h.is("span.undo")?h.hasClass("unspam")?(k=-1,"trash"===l?w=1:"1"===l?r=1:"0"===l&&(q=1)):h.hasClass("untrash")&&(w=-1,"spam"===l?k=1:"1"===l?r=1:"0"===l&&(q=1)):h.is("span.spam")?(n?r=-1:p?q=-1:m&&(w=-1),k=1):h.is("span.unspam")?(n?q=1:p?r=1:m?h.hasClass("approve")?r=1:h.hasClass("unapprove")&&
(q=1):v&&(h.hasClass("approve")?r=1:h.hasClass("unapprove")&&(q=1)),k=-1):h.is("span.trash")?(n?r=-1:p?q=-1:v&&(k=-1),w=1):h.is("span.untrash")?(n?q=1:p?r=1:m&&(h.hasClass("approve")?r=1:h.hasClass("unapprove")&&(q=1)),w=-1):h.is("span.approve:not(.unspam):not(.untrash)")?(r=1,q=-1):h.is("span.unapprove:not(.unspam):not(.untrash)")?(r=-1,q=1):h.is("span.delete")&&(v?k=-1:m&&(w=-1));q&&(y(q,g),x("span.all-count",q));r&&(z(r,g),x("span.all-count",r));k&&x("span.spam-count",k);w&&x("span.trash-count",
w);if(!B)if(g=b.val()?parseInt(b.val(),10):0,a(e.target).parent().is("span.undo")?g++:g--,0>g&&(g=0),"object"===typeof c)if(f.supplemental.total_items_i18n&&C<f.supplemental.time){if(l=f.supplemental.total_items_i18n||"")a(".displaying-num").text(l),a(".total-pages").text(f.supplemental.total_pages_i18n),a(".tablenav-pages").find(".next-page, .last-page").toggleClass("disabled",f.supplemental.total_pages==a(".current-page").val());d(g,f.supplemental.time,!0)}else f.supplemental.time&&d(g,f.supplemental.time,
!1);else d(g,c,!1);theExtraList&&0!==theExtraList.size()&&0!==theExtraList.children().size()&&(theList.get(0).wpList.add(theExtraList.children(":eq(0):not(.no-items)").remove().clone()),t(),f=a(":animated","#the-comment-list"),l=function(){a("#the-comment-list tr:visible").length||theList.get(0).wpList.add(theExtraList.find(".no-items").clone())},f.length?f.promise().done(l):l())},addColor:"none"}).bind("wpListDelEnd",function(c,b){var d=a(b.target).attr("data-wp-lists"),e=b.element.replace(/[^0-9]+/g,
"");-1==d.indexOf(":trash=1")&&-1==d.indexOf(":spam=1")||a("#undo-"+e).fadeIn(300,function(){a(this).show()})})};commentReply={cid:"",act:"",init:function(){var b=a("#replyrow");a("a.cancel",b).click(function(){return commentReply.revert()});a("a.save",b).click(function(){return commentReply.send()});a("input#author-name, input#author-email, input#author-url",b).keypress(function(a){if(13==a.which)return commentReply.send(),a.preventDefault(),!1});a("#the-comment-list .column-comment > p").dblclick(function(){commentReply.toggle(a(this).parent())});
a("#doaction, #doaction2, #post-query-submit").click(function(){0<a("#the-comment-list #replyrow").length&&commentReply.close()});this.comments_listing=a('#comments-form > input[name="comment_status"]').val()||""},addEvents:function(b){b.each(function(){a(this).find(".column-comment > p").dblclick(function(){commentReply.toggle(a(this).parent())})})},toggle:function(b){"none"!==a(b).css("display")&&(a("#replyrow").parent().is("#com-reply")||window.confirm(adminCommentsL10n.warnQuickEdit))&&a(b).find("a.vim-q").click()},
revert:function(){if(1>a("#the-comment-list #replyrow").length)return!1;a("#replyrow").fadeOut("fast",function(){commentReply.close()});return!1},close:function(){var b,c=a("#replyrow");c.parent().is("#com-reply")||(this.cid&&"edit-comment"==this.act&&(b=a("#comment-"+this.cid),b.fadeIn(300,function(){b.show()}).css("backgroundColor","")),"undefined"!=typeof QTags&&QTags.closeAllTags("replycontent"),a("#add-new-comment").css("display",""),c.hide(),a("#com-reply").append(c),a("#replycontent").css("height",
"").val(""),a("#edithead input").val(""),a(".error",c).empty().hide(),a(".spinner",c).removeClass("is-active"),this.cid="")},open:function(b,c,e){var d,t,u,k=a("#comment-"+b),n=k.height(),p=0;this.close();this.cid=b;d=a("#replyrow");t=a("#inline-"+b);e=e||"replyto";u=this.act=("edit"==e?"edit":"replyto")+"-comment";p=a("> th:visible, > td:visible",k).length;d.hasClass("inline-edit-row")&&0!==p&&a("td",d).attr("colspan",p);a("#action",d).val(u);a("#comment_post_ID",d).val(c);a("#comment_ID",d).val(b);
"edit"==e?(a("#author-name",d).val(a("div.author",t).text()),a("#author-email",d).val(a("div.author-email",t).text()),a("#author-url",d).val(a("div.author-url",t).text()),a("#status",d).val(a("div.comment_status",t).text()),a("#replycontent",d).val(a("textarea.comment",t).val()),a("#edithead, #editlegend, #savebtn",d).show(),a("#replyhead, #replybtn, #addhead, #addbtn",d).hide(),120<n&&(b=500<n?500:n,a("#replycontent",d).css("height",b+"px")),k.after(d).fadeOut("fast",function(){a("#replyrow").fadeIn(300,
function(){a(this).show()})})):"add"==e?(a("#addhead, #addbtn",d).show(),a("#replyhead, #replybtn, #edithead, #editlegend, #savebtn",d).hide(),a("#the-comment-list").prepend(d),a("#replyrow").fadeIn(300)):(b=a("#replybtn",d),a("#edithead, #editlegend, #savebtn, #addhead, #addbtn",d).hide(),a("#replyhead, #replybtn",d).show(),k.after(d),k.hasClass("unapproved")?b.text(adminCommentsL10n.replyApprove):b.text(adminCommentsL10n.reply),a("#replyrow").fadeIn(300,function(){a(this).show()}));setTimeout(function(){var b,
c,d,e;b=a("#replyrow").offset().top;c=b+a("#replyrow").height();d=window.pageYOffset||document.documentElement.scrollTop;e=document.documentElement.clientHeight||window.innerHeight||0;d+e-20<c?window.scroll(0,c-e+35):b-20<d&&window.scroll(0,b-35);a("#replycontent").focus().keyup(function(a){27==a.which&&commentReply.revert()})},600);return!1},send:function(){var b={};a("#replysubmit .error").hide();a("#replysubmit .spinner").addClass("is-active");a("#replyrow input").not(":button").each(function(){var c=
a(this);b[c.attr("name")]=c.val()});b.content=a("#replycontent").val();b.id=b.comment_post_ID;b.comments_listing=this.comments_listing;b.p=a('[name="p"]').val();a("#comment-"+a("#comment_ID").val()).hasClass("unapproved")&&(b.approve_parent=1);a.ajax({type:"POST",url:ajaxurl,data:b,success:function(a){commentReply.show(a)},error:function(a){commentReply.error(a)}});return!1},show:function(b){var c,e,d;if("string"==typeof b)return this.error({responseText:b}),!1;c=wpAjax.parseAjaxResponse(b);if(c.errors)return this.error({responseText:wpAjax.broken}),
!1;this.revert();c=c.responses[0];b="#comment-"+c.id;"edit-comment"==this.act&&a(b).remove();if(c.supplemental.parent_approved&&(d=a("#comment-"+c.supplemental.parent_approved),y(-1,c.supplemental.parent_post_id),"moderated"==this.comments_listing)){d.animate({backgroundColor:"#CCEEBB"},400,function(){d.fadeOut()});return}c.supplemental.i18n_comments_text&&(B?A(c.supplemental):(z(1,c.supplemental.parent_post_id),x("span.all-count",1)));c=a.trim(c.data);a(c).hide();a("#replyrow").after(c);b=a(b);this.addEvents(b);
e=b.hasClass("unapproved")?"#FFFFE0":b.closest(".widefat, .postbox").css("backgroundColor");b.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:e},300,function(){d&&d.length&&d.animate({backgroundColor:"#CCEEBB"},300).animate({backgroundColor:e},300).removeClass("unapproved").addClass("approved").find("div.comment_status").html("1")})},error:function(b){var c=b.statusText;a("#replysubmit .spinner").removeClass("is-active");b.responseText&&(c=b.responseText.replace(/<.[^<>]*?>/g,""));
c&&a("#replysubmit .error").html(c).show()},addcomment:function(b){var c=this;a("#add-new-comment").fadeOut(200,function(){c.open(0,b,"add");a("table.comments-box").css("display","");a("#no-comments").remove()})}};a(document).ready(function(){var b,c,e,d;setCommentsList();commentReply.init();a(document).on("click","span.delete a.delete",function(a){a.preventDefault()});"undefined"!=typeof a.table_hotkeys&&(b=function(b){return function(){var c,d;c="next"==b?"first":"last";d=a(".tablenav-pages ."+
b+"-page:not(.disabled)");d.length&&(window.location=d[0].href.replace(/\&hotkeys_highlight_(first|last)=1/g,"")+"&hotkeys_highlight_"+c+"=1")}},c=function(b,c){window.location=a("span.edit a",c).attr("href")},e=function(){a("#cb-select-all-1").data("wp-toggle",1).trigger("click").removeData("wp-toggle")},d=function(b){return function(){var c=a('select[name="action"]');a('option[value="'+b+'"]',c).prop("selected",!0);a("#doaction").click()}},a.table_hotkeys(a("table.widefat"),["a","u","s","d","r",
"q","z",["e",c],["shift+x",e],["shift+a",d("approve")],["shift+s",d("spam")],["shift+d",d("delete")],["shift+t",d("trash")],["shift+z",d("untrash")],["shift+u",d("unapprove")]],{highlight_first:adminCommentsL10n.hotkeys_highlight_first,highlight_last:adminCommentsL10n.hotkeys_highlight_last,prev_page_link_cb:b("prev"),next_page_link_cb:b("next"),hotkeys_opts:{disableInInput:!0,type:"keypress",noDisable:'.check-column input[type="checkbox"]'},cycle_expr:"#the-comment-list tr",start_row_index:0}));
a("#the-comment-list").on("click",".comment-inline",function(b){b.preventDefault();b=a(this);var c="replyto";"undefined"!==typeof b.data("action")&&(c=b.data("action"));commentReply.open(b.data("commentId"),b.data("postId"),c)})})})(jQuery);
